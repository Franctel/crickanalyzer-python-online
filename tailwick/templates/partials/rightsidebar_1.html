{% block rightsidebar %}
<div class="fixed items-center hidden bottom-6 right-12 h-header group-data-[navbar=hidden]:flex">
    <!-- âš™ï¸ Floating settings button -->
    <button data-drawer-target="customizerButton" data-drawer-toggle="customizerButton" type="button"
        class="inline-flex items-center justify-center size-12 p-0 transition-all duration-200 ease-linear rounded-md shadow-lg text-sky-50 bg-sky-500">
        <i data-lucide="settings" class="inline-block size-5"></i>
    </button>
</div>

<!-- ðŸ“‚ Video Path Sidebar -->
<div id="customizerButton" drawer-end 
    class="fixed inset-y-0 flex flex-col w-full transition-transform duration-300 ease-in-out transform translate-x-full bg-white shadow ltr:right-0 rtl:left-0 md:w-96 z-drawer dark:bg-zink-700">

    <!-- Header -->
    <div class="flex justify-between items-center p-4 border-b border-slate-200 dark:border-zink-600">
        <h5 class="text-lg font-semibold text-slate-700 dark:text-zink-100">Set Video Path</h5>
        <button data-drawer-close="customizerButton"
            class="p-1 text-slate-500 hover:text-slate-800 dark:text-zink-200 dark:hover:text-zink-50">
            <i data-lucide="x" class="size-5"></i>
        </button>
    </div>

    <!-- Content -->
    <div class="flex-1 p-6">
        <label for="video-path" class="block mb-2 text-sm font-medium text-slate-700 dark:text-zink-200">
            Video Path
        </label>
        <div class="flex gap-2">
            <input type="text" id="video-path" name="video-path" placeholder="C:\\MatchVideos"
                class="flex-1 px-3 py-2 text-sm border rounded-md shadow-sm border-slate-300 focus:ring focus:ring-sky-200 dark:bg-zink-600 dark:border-zink-500 dark:text-zink-100">
            
            <!-- Browse Button -->
            <button type="button" id="browseBtn"
                class="px-3 py-2 text-sm font-medium text-white bg-sky-500 rounded-md hover:bg-sky-600 focus:ring focus:ring-sky-200">
                Browse
            </button>
        </div>
    </div>

    <!-- Footer Buttons -->
    <div class="flex items-center justify-end gap-3 p-4 border-t border-slate-200 dark:border-zink-600">
        <button data-drawer-close="customizerButton" type="button"
            class="px-4 py-2 text-sm font-medium text-slate-600 bg-slate-200 rounded-md hover:bg-slate-300 dark:bg-zink-600 dark:text-zink-200">
            Cancel
        </button>
        <button type="button" id="savePathBtn"
            class="px-4 py-2 text-sm font-medium text-white bg-sky-500 rounded-md hover:bg-sky-600">
            OK
        </button>
    </div>
</div>

<!-- ðŸ“œ JS for Browse + Save -->
<script>
document.addEventListener("DOMContentLoaded", () => {
    // ðŸ“‚ Browse button click -> call backend to open Tkinter dialog
    document.getElementById("browseBtn").addEventListener("click", async () => {
        try {
            const res = await fetch("/browse-folder");
            const data = await res.json();
            if (data.folder) {
                document.getElementById("video-path").value = data.folder;
            } else {
                alert("No folder selected");
            }
        } catch (err) {
            console.error("Browse error:", err);
            alert("Failed to open folder dialog");
        }
    });

    // ðŸ’¾ Save path (you can POST this to backend or store in localStorage)
    document.getElementById("savePathBtn").addEventListener("click", async () => {
        const path = document.getElementById("video-path").value;
        if (!path) {
            alert("Please select a folder first");
            return;
        }
        console.log("Selected path:", path);
        // Example: store in localStorage (for offline use)
        localStorage.setItem("videoPath", path);

        // Example: send to backend for persistence
        await fetch("/set-video-path", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ folder: path })
        });

        alert("Video path saved: " + path);
    });
});
</script>
{% endblock rightsidebar %}

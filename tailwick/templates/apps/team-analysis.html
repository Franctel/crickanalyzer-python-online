{% extends 'partials/base.html' %}
{% block title %} TEAM ANALYSIS {% endblock %}
{% block content %}

<div class="order-6 col-span-12 2xl:order-1 card 2xl:col-span-12">
  <div class="card-body">

    <!-- Toggle Button (matched with apps-chat.html) -->
    <button type="button" id="toggle-filter-btn"
        class="flex items-center justify-between w-full px-4 py-2 mb-4 text-lg font-semibold text-left text-white bg-custom-500 rounded-md hover:bg-custom-600 focus:outline-none focus-visible:ring focus-visible:ring-custom-500 focus-visible:ring-opacity-75">
        <span class="text-lg font-semibold">Filters</span>
        <svg id="filter-arrow" xmlns="http://www.w3.org/2000/svg" width="28" height="28"
            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round"
            class="w-6 h-6 transition-transform duration-200">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    </button>

    <!-- ========================== FILTERS ========================== -->
    <div id="filter-section">
      <form id="filter-form" method="POST" class="flex flex-col gap-3 md:flex-row md:items-end md:gap-4">

        <!-- Tournament -->
        <div class="relative w-full md:w-1/4">
          <label for="tournament" class="block mb-1 text-xl font-medium text-slate-600 dark:text-zink-200">
            Tournament
          </label>

          <select id="tournament" name="tournament" onchange="this.form.submit()" 
            class="form-select w-full text-lg border border-slate-300 dark:border-zink-600 dark:bg-zink-700 dark:text-zink-100">
            <option value="" disabled {% if not selected_tournament %}selected{% endif %} class="text-lg">
              Select Tournament
            </option>
            {% for t in tournaments %}
              <option value="{{ t.value }}" class="text-lg"
                      {% if selected_tournament and selected_tournament|int == t.value %}selected{% endif %}>
                {{ t.label }}
              </option>
            {% endfor %}
          </select>
        </div>

        <!-- Team -->
        <div class="relative w-full md:w-1/4">
          <label for="team" class="block mb-1 text-xl font-medium text-slate-600 dark:text-zink-200">
            Team
          </label>

          <select id="team" name="team" onchange="this.form.submit()" 
            class="form-select w-full text-lg border border-slate-300 dark:border-zink-600 dark:bg-zink-700 dark:text-zink-100">
            <option disabled {% if not selected_team %}selected{% endif %} class="text-lg">
              Select Team
            </option>
            {% for team in teams %}
              <option value="{{ team }}" class="text-lg"
                      {% if selected_team == team %}selected{% endif %}>
                {{ team }}
              </option>
            {% endfor %}
          </select>
        </div>

        <!-- Matches -->
        <div class="relative w-full md:w-1/4">
          <label for="matches" class="block mb-1 text-xl font-medium text-slate-600 dark:text-zink-200">
            Matches
          </label>

          <select id="matches" name="matches[]" multiple
                  data-choices data-choices-removeItem
                  onchange="this.form.submit()"
                  class="form-input w-full text-lg border-slate-300 dark:border-zink-600 dark:bg-zink-700 dark:text-zink-100">

            <!-- All option -->
            <option value="All" class="text-lg"
                    {% if 'All' in (selected_matches_raw or []) %}selected{% endif %}>
              All
            </option>

            {% for m in matches %}
              <option value="{{ m }}" class="text-lg"
                      {% if m in (selected_matches_raw or []) %}selected{% endif %}>
                {{ m }}
              </option>
            {% endfor %}
          </select>
          
          <!-- Hidden field to store actual match list for modal -->
          <input type="hidden" id="actualMatches" value='{{ selected_matches | tojson | safe if selected_matches else "[]" }}'>
        </div>


        <!-- Batting / Bowling -->
        <div class="flex flex-col gap-2 md:w-1/5 md:self-end mt-4">
          <label class="inline-flex items-center text-lg">
            <input type="radio" name="view_type" value="batting"
                   class="form-radio text-custom-500"
                   {% if view_type=='batting' %}checked{% endif %}
                   onchange="this.form.submit()">
            <span class="ml-2 text-slate-700 dark:text-zink-100">Batting</span>
          </label>

          <label class="inline-flex items-center text-lg">
            <input type="radio" name="view_type" value="bowling"
                   class="form-radio text-custom-500"
                   {% if view_type=='bowling' %}checked{% endif %}
                   onchange="this.form.submit()">
            <span class="ml-2 text-slate-700 dark:text-zink-100">Bowling</span>
          </label>
        </div>

        <!-- Generate -->
        <div class="relative w-full md:w-1/5">
          <button type="submit"
                  class="h-[42px] px-6 btn bg-custom-500 text-white hover:bg-custom-600 text-lg mt-6">
            Generate
          </button>
        </div>

      </form>

      <!-- âœ… FONT SIZE for Choices.js â€“ same as apps-chat.html -->
      <style>
          /* Card heading fix for PDF export */
          .card-heading, .card-title, .card-header, h2, h3 {
            padding-top: 18px !important;
            padding-bottom: 14px !important;
            font-size: 1.25rem !important;
            line-height: 1.2 !important;
            overflow: visible !important;
            white-space: normal !important;
            word-break: break-word !important;
          }
          @media print {
            .card-heading, .card-title, .card-header, h2, h3 {
              padding-top: 22px !important;
              padding-bottom: 18px !important;
              font-size: 1.3rem !important;
              line-height: 1.2 !important;
              overflow: visible !important;
              white-space: normal !important;
              word-break: break-word !important;
            }
          }
        .choices__inner,
        .choices__list--dropdown .choices__item,
        .choices__list--single .choices__item,
        .choices__list .choices__item {
          font-size: 18px !important;
        }
        .choices__inner {
          min-height: 48px;
          padding-top: 10px;
          padding-bottom: 10px;
        }
        .choices__list--multiple .choices__item {
          font-size: 18px !important;
          padding: 6px 10px;
        }

        /* Custom tooltip styling - larger text */
        .card[data-tooltip] {
          position: relative;
        }
        
        /* Custom tooltip appears on hover with larger font */
        .card[data-tooltip]:hover::before {
          content: attr(data-tooltip);
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          background-color: rgba(0, 0, 0, 0.9);
          color: white;
          padding: 12px 16px;
          border-radius: 8px;
          font-size: 18px;
          white-space: nowrap;
          z-index: 1000;
          margin-bottom: 8px;
          pointer-events: none;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
          animation: fadeIn 0.2s ease-in;
        }
        
        .card[data-tooltip]:hover::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          border: 6px solid transparent;
          border-top-color: rgba(0, 0, 0, 0.9);
          z-index: 1000;
          pointer-events: none;
          animation: fadeIn 0.2s ease-in;
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        /* POWERPLAY PERFORMANCE */
        .powerplay-title {
            color:#A78BFA !important;       /* Purple */
        }
        .middle-title {
            color:#38BDF8 !important;       /* Blue */
        }
        .slog-title {
            color:#F472B6 !important;       /* Pink */
        }

        .fixed-green {
            color:#4ADE80 !important;   /* text-green-400 */
            font-weight:800 !important; /* font-extrabold */
        }

        .fixed-yellow {
            color:#FDE047 !important;   /* text-yellow-300 */
            font-weight:800 !important; 
        }

        /* PDF Page Break Styles */
        .col-span-12 {
          page-break-inside: avoid !important;
          break-inside: avoid !important;
          page-break-before: auto !important;
          page-break-after: auto !important;
        }
        
        .card {
          page-break-inside: avoid !important;
          break-inside: avoid !important;
        }
        
        .card-body {
          page-break-inside: avoid !important;
          break-inside: avoid !important;
        }
        
        @media print {
          .card, .card-body {
            page-break-inside: avoid !important;
            break-inside: avoid !important;
          }
          .col-span-12 {
            page-break-inside: avoid !important;
            break-inside: avoid !important;
            page-break-before: auto !important;
          }
          .page-break-before {
            page-break-before: always !important;
            break-before: always !important;
          }
          .page-break-after {
            page-break-after: always !important;
            break-after: always !important;
          }
        }

      </style>

      <!-- âœ… JS: when "All" selected, show only 'All' chip, backend still sees All -->
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          // Move title to data-tooltip to prevent default browser tooltip
          document.querySelectorAll('.card[title]').forEach(card => {
            const title = card.getAttribute('title');
            if (title) {
              card.setAttribute('data-tooltip', title);
              card.removeAttribute('title');
            }
          });

          const matchSelect = document.querySelector("#matches");
          if (!matchSelect) return;

          matchSelect.addEventListener("change", function () {
            const allOption = matchSelect.querySelector('option[value="All"]');
            if (!allOption) return;

            const selectedValues = Array.from(matchSelect.selectedOptions).map(o => o.value);

            // If "All" is selected â†’ keep ONLY "All" selected (visual),
            // apps.py will convert "All" to all matches server-side.
            if (selectedValues.includes("All")) {
              Array.from(matchSelect.options).forEach(opt => {
                opt.selected = (opt.value === "All");
              });
            }

            // Sync Choices.js UI if initialized
            if (matchSelect.choices) {
              matchSelect.choices.setChoices(
                Array.from(matchSelect.options).map(o => ({
                  value: o.value,
                  label: o.label || o.textContent,
                  selected: o.selected,
                  disabled: o.disabled
                })),
                "value", "label", true
              );
            }
          });
        });
          // Set Matches filter to 'All' by default if Team and Tournament are selected and no match is selected
          const teamSelect = document.querySelector('#team');
          const tournamentSelect = document.querySelector('#tournament');
          const matchSelect = document.querySelector('#matches');
          if (teamSelect && tournamentSelect && matchSelect) {
            const teamSelected = teamSelect.value && teamSelect.value !== '';
            const tournamentSelected = tournamentSelect.value && tournamentSelect.value !== '';
            const anyMatchSelected = Array.from(matchSelect.selectedOptions).length > 0;
            if (teamSelected && tournamentSelected && !anyMatchSelected) {
              const allOption = matchSelect.querySelector('option[value="All"]');
              if (allOption) {
                allOption.selected = true;
                // Sync Choices.js UI if initialized
                if (matchSelect.choices) {
                  matchSelect.choices.setChoiceByValue('All');
                }
              }
            }
          }
          // Move title to data-tooltip to prevent default browser tooltip
          document.querySelectorAll('.card[title]').forEach(card => {
            const title = card.getAttribute('title');
            if (title) {
              card.setAttribute('data-tooltip', title);
              card.removeAttribute('title');
            }
          });

          if (matchSelect) {
            matchSelect.addEventListener("change", function () {
              const allOption = matchSelect.querySelector('option[value="All"]');
              if (!allOption) return;

              const selectedValues = Array.from(matchSelect.selectedOptions).map(o => o.value);

              // If "All" is selected â†’ keep ONLY "All" selected (visual),
              // apps.py will convert "All" to all matches server-side.
              if (selectedValues.includes("All")) {
                Array.from(matchSelect.options).forEach(opt => {
                  opt.selected = (opt.value === "All");
                });
              }

              // Sync Choices.js UI if initialized
              if (matchSelect.choices) {
                matchSelect.choices.setChoices(
                  Array.from(matchSelect.options).map(o => ({
                    value: o.value,
                    label: o.label || o.textContent,
                    selected: o.selected,
                    disabled: o.disabled
                  })),
                  "value", "label", true
                );
              }
            });
          }
        });
      </script>

    </div>

  </div>
</div>

{% if show_distribution_card %}

<!-- ================== TABS STRIP ABOVE INNING WISE MATCH DISTRIBUTION ================== -->
<div class="mt-6 border-b border-gray-200 dark:border-zink-600">
  <ul class="flex flex-wrap -mb-px text-xl font-semibold text-center" role="tablist">

      <li class="mr-2">
          <button id="tab-phase" type="button"
              class="inline-block px-5 py-3 text-custom-600 border-b-2 border-custom-500 rounded-t-lg active dark:text-custom-300 dark:border-custom-400"
              onclick="switchDistributionTab('phase')">
              Phase Wise
          </button>
      </li>

      <li class="mr-2">
          <button id="tab-order" type="button"
              class="inline-block px-5 py-3 text-slate-500 hover:text-custom-600 border-b-2 border-transparent rounded-t-lg dark:text-zink-300 dark:hover:text-custom-400"
              onclick="switchDistributionTab('order')">
              Order Wise
          </button>
      </li>

      <li class="mr-2">
          <button id="tab-area" type="button"
              class="inline-block px-5 py-3 text-slate-500 hover:text-custom-600 border-b-2 border-transparent rounded-t-lg dark:text-zink-300 dark:hover:text-custom-400"
              onclick="switchDistributionTab('area')">
              Area Wise
          </button>
      </li>

      <!-- â­ NEW TAB â€” PACE & SPIN â­ -->
      <li class="mr-2">
          <button id="tab-pace_spin" type="button"
              class="inline-block px-5 py-3 text-slate-500 hover:text-custom-600 border-b-2 border-transparent rounded-t-lg dark:text-zink-300 dark:hover:text-custom-400"
              onclick="switchDistributionTab('pace_spin')">
              Pace & Spin
          </button>
      </li>

      <li class="mr-2">
          <button id="tab-graphs" type="button"
              class="inline-block px-5 py-3 text-slate-500 hover:text-custom-600 border-b-2 border-transparent rounded-t-lg dark:text-zink-300 dark:hover:text-custom-400"
              onclick="switchDistributionTab('graphs')">
              Graphs
          </button>
      </li>

  </ul>
</div>


<!-- ================== PHASE WISE CONTENT (EXISTING FULL CONTENT) ================== -->
<div id="phaseWiseDiv">
  {% if view_type == 'batting' %}

  <!-- PDF Download Button and Info Note -->
  <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
    <button id="downloadPhasePDF" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download PDF
    </button>

    <!-- Info Note -->
    <div class="flex-1 min-w-[400px]">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
        <div class="flex items-start gap-3">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
            <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
              Click on phase card to view detailed match stats and download.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="pdfContent">
  <!-- ========================== RESULT CARD #1 (SPLIT: TEAM vs OPPONENTS) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Left: Selected Team -->
        <div class="flex flex-col items-center w-full">
          <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
            Inning Wise <br> Match Distribution<br>
            <span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span>
          </h2>
          <div class="flex flex-col gap-4 w-full">
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 1st</span>
              <span class="font-extrabold text-green-400" style="font-size:60px;">{{ batting_first_count }}</span>
            </div>
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 2nd</span>
              <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ batting_second_count }}</span>
            </div>
          </div>
        </div>
        <!-- Right: Opponent Teams Against Us -->
        <div class="flex flex-col items-center w-full">
          <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
            Inning Wise <br> Match Distribution<br>
            <span class="text-xl font-semibold text-red-500">(Opponents)</span>
          </h2>
          <div class="flex flex-col gap-4 w-full">
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 1st</span>
              <span class="font-extrabold text-green-400" style="font-size:60px;">{{ opp_batting_first_count }}</span>
            </div>
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 2nd</span>
              <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ opp_batting_second_count }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== RESULT CARD #2 â€” POWERPLAY PERFORMANCE (VERTICAL, TEAM & OPPONENTS) ========================== -->
  <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Left: Selected Team -->
    <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Powerplay Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 1, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ pp1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg. Strike Rate</span> <span>{{ pp1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ pp1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ pp1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ pp1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ pp1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 2, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ pp2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ pp2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ pp2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ pp2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ pp2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ pp2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Right: Opponent Teams Against Us -->
    <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Powerplay Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 1, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_pp1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg. Strike Rate</span> <span>{{ opp_pp1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_pp1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_pp1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_pp1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_pp1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 2, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_pp2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ opp_pp2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_pp2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_pp2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_pp2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_pp2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== RESULT CARD #3 â€” MIDDLE OVERS PERFORMANCE (VERTICAL, TEAM & OPPONENTS) ========================== -->
  <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Left: Selected Team -->
    <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Overs Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 1, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ mo1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ mo1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ mo1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ mo1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ mo1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ mo1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 2, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ mo2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ mo2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ mo2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ mo2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ mo2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ mo2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Right: Opponent Teams Against Us -->
    <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Overs Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 1, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_mo1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ opp_mo1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_mo1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_mo1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_mo1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_mo1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 2, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_mo2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ opp_mo2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_mo2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_mo2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_mo2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_mo2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- ========================== RESULT CARD #4 â€” SLOG OVERS PERFORMANCE (VERTICAL, TEAM & OPPONENTS) ========================== -->
  <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
    <!-- Left: Selected Team -->
    <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Slog Overs Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 1, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ so1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ so1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ so1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ so1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ so1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ so1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 2, 'batting')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ so2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ so2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ so2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ so2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ so2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ so2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Right: Opponent Teams Against Us -->
    <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
      <div class="card-body flex flex-col items-center gap-6">
        <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Slog Overs Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
        <!-- Batting 1st vertically -->
        <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 1, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-green-300 text-center mb-2">Batting 1st</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_so1_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ opp_so1_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_so1_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_so1_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_so1_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_so1_sixes }}</span></div>
          </div>
        </div>
        <!-- Batting 2nd vertically -->
        <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 2, 'batting_opponent')" title="Click on phase card to view detailed match stats and download.">
          <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Batting 2nd</h3>
          <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs</span> <span>{{ opp_so2_avg_runs }}</span></div>
          <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Strike Rate</span> <span>{{ opp_so2_sr }}</span></div>
          <hr class="my-4 border-gray-600">
          <div class="flex justify-between w-full mt-4">
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_so2_dots }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_so2_wkts }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_so2_fours }}</span></div>
            <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_so2_sixes }}</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>



  {% elif view_type == 'bowling' %}

    <!-- PDF Download Button for Phase Wise Bowling -->
    <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
        <button id="downloadPhasePDFBowling" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Download PDF
        </button>
        <div class="flex-1 min-w-[400px]">
          <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
            <div class="flex items-start gap-3">
              <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div>
                <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
                <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
                  Click on phase card to view detailed match stats and download.
                </p>
              </div>
            </div>
          </div>
        </div>
    </div>



  <!-- ========== PHASE WISE BOWLING CARDS (NEW LAYOUT: TEAM VS OPPONENTS, MATCHES BATTING PHASE WISE) ========== -->
  <div id="phaseBowlingCards">
    <!-- Inning Wise Match Distribution (Bowling) -->
    <div class="col-span-12 mt-6">
      <div class="card">
        <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-8">
          <!-- Left: Selected Team -->
          <div class="flex flex-col items-center w-full">
            <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
              Inning Wise <br> Match Distribution<br>
              <span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span>
            </h2>
            <div class="flex flex-col gap-4 w-full">
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 1st</span>
                <span class="font-extrabold text-green-400" style="font-size:60px;">{{ bowling_first_count }}</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 2nd</span>
                <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ bowling_second_count }}</span>
              </div>
            </div>
          </div>
          <!-- Right: Opponent Teams Against Us -->
          <div class="flex flex-col items-center w-full">
            <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
              Inning Wise <br> Match Distribution<br>
              <span class="text-xl font-semibold text-red-500">(Opponents)</span>
            </h2>
            <div class="flex flex-col gap-4 w-full">
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 1st</span>
                <span class="font-extrabold text-green-400" style="font-size:60px;">{{ opp_bowling_first_count }}</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 2nd</span>
                <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ opp_bowling_second_count }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Powerplay Performance (Bowling) -->
    <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Left: Selected Team -->
      <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Powerplay Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ pp1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ pp1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ pp1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ pp1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ pp1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ pp1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ pp2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ pp2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ pp2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ pp2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ pp2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ pp2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Right: Opponent Teams Against Us -->
      <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Powerplay Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 1, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_pp1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_pp1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_pp1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_pp1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_pp1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_pp1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('pp', 2, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_pp2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_pp2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_pp2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_pp2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_pp2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_pp2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Middle Overs Performance (Bowling) -->
    <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Left: Selected Team -->
      <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Overs Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ mo1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ mo1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ mo1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ mo1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ mo1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ mo1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ mo2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ mo2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ mo2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ mo2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ mo2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ mo2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Right: Opponent Teams Against Us -->
      <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Overs Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 1, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_mo1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_mo1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_mo1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_mo1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_mo1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_mo1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('mo', 2, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_mo2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_mo2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_mo2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_mo2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_mo2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_mo2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Slog Overs Performance (Bowling) -->
    <div class="col-span-12 mt-6 grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Left: Selected Team -->
      <div class="card bg-slate-800/40 border border-custom-500 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Slog Overs Performance<br><span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ so1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ so1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ so1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ so1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ so1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ so1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ so2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ so2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ so2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ so2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ so2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ so2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Right: Opponent Teams Against Us -->
      <div class="card bg-slate-800/40 border border-red-400 p-6 rounded-xl shadow-xl">
        <div class="card-body flex flex-col items-center gap-6">
          <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Slog Overs Performance<br><span class="text-xl font-semibold text-red-500">(Opponents)</span></h2>
          <!-- Bowling 1st -->
          <div class="w-full mb-4 card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 1, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-2">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_so1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_so1_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_so1_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_so1_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_so1_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_so1_sixes }}</span></div>
            </div>
          </div>
          <!-- Bowling 2nd -->
          <div class="w-full card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer" onclick="openPhaseModal('so', 2, 'bowling_opponent')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Avg Runs Conceded</span> <span>{{ opp_so2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Economy</span> <span>{{ opp_so2_sr }}</span></div>
            <hr class="my-4 border-gray-600">
            <div class="flex justify-between w-full mt-4">
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Dots</span><span class="block text-2xl font-bold mt-1">{{ opp_so2_dots }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Wickets</span><span class="block text-2xl font-bold text-red-400 mt-1">{{ opp_so2_wkts }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Fours</span><span class="block text-2xl font-bold text-green-400 mt-1">{{ opp_so2_fours }}</span></div>
              <div class="w-1/4 text-center"><span class="text-lg">Avg. Sixes</span><span class="block text-2xl font-bold text-orange-400 mt-1">{{ opp_so2_sixes }}</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================ RESULT CARD #2 â€” POWERPLAY BOWLING ============================ -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Powerplay Performance</h2>
        <div class="grid grid-cols-2 gap-10 w-full">

          <!-- BOWLING 1ST -->
          <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('pp', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-3">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ pp1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ pp1_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ pp1_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ pp1_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ pp1_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ pp1_sixes }}</span>
                </div>
            </div>

          </div>

          <!-- BOWLING 2ND -->
          <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('pp', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ pp2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ pp2_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ pp2_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ pp2_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ pp2_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ pp2_sixes }}</span>
                </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================ RESULT CARD #3 â€” MIDDLE OVERS BOWLING ============================ -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Overs Performance</h2>
        <div class="grid grid-cols-2 gap-10 w-full">

          <!-- Inning 1 -->
          <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('mo', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-3">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ mo1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ mo1_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ mo1_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ mo1_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ mo1_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ mo1_sixes }}</span>
                </div>
            </div>

          </div>

          <!-- Inning 2 -->
          <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('mo', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ mo2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ mo2_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ mo2_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ mo2_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ mo2_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ mo2_sixes }}</span>
                </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================ RESULT CARD #4 â€” SLOG OVERS BOWLING ============================ -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Slog Overs Performance</h2>
        <div class="grid grid-cols-2 gap-10 w-full">

          <!-- Inning 1 -->
          <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('so', 1, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-3">Bowling 1st</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ so1_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ so1_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ so1_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ so1_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ so1_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ so1_sixes }}</span>
                </div>
            </div>

          </div>

          <!-- Inning 2 -->
          <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" 
               onclick="openPhaseModal('so', 2, 'bowling')" title="Click on phase card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Bowling 2nd</h3>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2"><span>Avg Runs Conceded</span><span>{{ so2_avg_runs }}</span></div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg"><span>Economy</span><span>{{ so2_sr }}</span></div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-6">
                <div class="w-1/4 text-center">
                    <span class="text-lg">Dots</span>
                    <span class="block text-2xl font-bold">{{ so2_dots }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Wickets</span>
                    <span class="block text-2xl font-bold text-red-400">{{ so2_wkts }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Fours</span>
                    <span class="block text-2xl font-bold text-green-400">{{ so2_fours }}</span>
                </div>

                <div class="w-1/4 text-center">
                    <span class="text-lg">Sixes</span>
                    <span class="block text-2xl font-bold text-orange-400">{{ so2_sixes }}</span>
                </div>
            </div>

          </div>
          
        </div>
      </div>
    </div>
  </div>

  {% endif %}
  </div> <!-- End pdfContent -->

<script>
// Phase Wise Bowling PDF Download (all phase cards, like batting)
document.addEventListener("DOMContentLoaded", function () {
  var btn = document.getElementById('downloadPhasePDFBowling');
  if (!btn) return;
  btn.addEventListener('click', async function() {
    // Ensure jsPDF is available as window.jspdf (for all browsers)
    if (window.jspdf === undefined && window.jspdf?.jsPDF === undefined && window.jspdf_umd !== undefined) {
      window.jspdf = window.jspdf_umd;
    }
    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
    // Select all phase cards for bowling
    const phaseCards = document.querySelectorAll('#phaseBowlingCards > .col-span-12');
    if (!phaseCards.length) return;
    btn.disabled = true;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
    try {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
      const pdfWidth = 297;
      const pdfHeight = 210;
      const margin = 10;
      const contentWidth = pdfWidth - (2 * margin);
      const contentHeight = pdfHeight - (2 * margin);
      for (let i = 0; i < phaseCards.length; i++) {
        const card = phaseCards[i];
        const canvas = await html2canvas(card, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: backgroundColor,
          windowWidth: card.scrollWidth,
          windowHeight: card.scrollHeight
        });
        const imgData = canvas.toDataURL('image/jpeg', 0.98);
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const widthRatio = contentWidth / (imgWidth * 0.264583);
        const heightRatio = contentHeight / (imgHeight * 0.264583);
        const ratio = Math.min(widthRatio, heightRatio);
        const scaledWidth = (imgWidth * 0.264583) * ratio;
        const scaledHeight = (imgHeight * 0.264583) * ratio;
        const xPos = margin + (contentWidth - scaledWidth) / 2;
        const yPos = margin + (contentHeight - scaledHeight) / 2;
        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
      }
      const now = new Date();
      const filename = `Phase_Wise_Bowling_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
      pdf.save(filename);
    } catch (error) {
      console.error('PDF generation error:', error);
      alert('Error generating PDF. Please try again.');
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  });
});
</script>
</div>

<!-- ================== ORDER WISE (ONLY INNING WISE DISTRIBUTION) ================== -->
<!-- ================== ORDER WISE (TOP / MIDDLE / LOWER) ================== -->
<div id="orderWiseDiv" style="display:none;">
  {% if view_type == 'batting' %}

  <!-- PDF Download Button and Info Note -->
  <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
    <button id="downloadOrderPDF" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download PDF
    </button>

    <!-- Info Note -->
    <div class="flex-1 min-w-[400px]">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
        <div class="flex items-start gap-3">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
            <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
              Click on order card to view detailed match stats and download.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="orderPDFContent">
  <!-- ========== SPLIT INNING WISE MATCH DISTRIBUTION (BATTING) ========== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Left: Selected Team -->
        <div class="flex flex-col items-center w-full">
          <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
            Inning Wise <br> Match Distribution<br>
            <span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span>
          </h2>
          <div class="flex flex-col gap-4 w-full">
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 1st</span>
              <span class="font-extrabold text-green-400" style="font-size:60px;">{{ batting_first_count }}</span>
            </div>
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 2nd</span>
              <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ batting_second_count }}</span>
            </div>
          </div>
        </div>
        <!-- Right: Opponent Teams Against Us -->
        <div class="flex flex-col items-center w-full">
          <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
            Inning Wise <br> Match Distribution<br>
            <span class="text-xl font-semibold text-red-500">(Opponents)</span>
          </h2>
          <div class="flex flex-col gap-4 w-full">
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 1st</span>
              <span class="font-extrabold text-green-400" style="font-size:60px;">{{ opp_batting_first_count }}</span>
            </div>
            <div class="flex flex-col items-center">
              <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Batting 2nd</span>
              <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ opp_batting_second_count }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== TOP ORDER (BATTING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Top Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT SIDE: VCA -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-purple-400 mb-2">Top Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 1, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[1]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[1]["Top Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 2, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[2]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[2]["Top Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT SIDE: OPPONENTS -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-purple-400 mb-2">Top Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 1, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[1]["Top Order"]["avg_runs"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["avg_runs"] is not none else 0 }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[1]["Top Order"]["sr"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["sr"] is not none else 0 }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["Dots"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["Dots"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Top Order"]["Wkts"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["Wkts"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Top Order"]["4s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["4s"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Top Order"]["6s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["6s"] is not none else 0 }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["30+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["30+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["50+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["50+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["100+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Top Order"] and opp_order_stats[1]["Top Order"]["100+"] is not none else 0 }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 2, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[2]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[2]["Top Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== MIDDLE ORDER (BATTING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT SIDE: VCA -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-blue-400 mb-2">Middle Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 1, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[1]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[1]["Middle Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 2, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[2]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[2]["Middle Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT SIDE: OPPONENTS -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-blue-400 mb-2">Middle Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 1, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[1]["Middle Order"]["avg_runs"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["avg_runs"] is not none else 0 }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[1]["Middle Order"]["sr"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["sr"] is not none else 0 }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["Dots"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["Dots"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["Wkts"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["Wkts"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["4s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["4s"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["6s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["6s"] is not none else 0 }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["30+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["30+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["50+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["50+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["100+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Middle Order"] and opp_order_stats[1]["Middle Order"]["100+"] is not none else 0 }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 2, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[2]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[2]["Middle Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== LOWER ORDER (BATTING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Lower Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT SIDE: VCA -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-pink-400 mb-2">Lower Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 1, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[1]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[1]["Lower Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 2, 'batting')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ order_stats[2]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ order_stats[2]["Lower Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT SIDE: OPPONENTS -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-pink-400 mb-2">Lower Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Batting 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 1, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Batting 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[1]["Lower Order"]["avg_runs"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["avg_runs"] is not none else 0 }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[1]["Lower Order"]["sr"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["sr"] is not none else 0 }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["Dots"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["Dots"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["Wkts"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["Wkts"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["4s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["4s"] is not none else 0 }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["6s"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["6s"] is not none else 0 }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["30+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["30+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["50+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["50+"] is not none else 0 }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["100+"] if opp_order_stats and opp_order_stats[1] and opp_order_stats[1]["Lower Order"] and opp_order_stats[1]["Lower Order"]["100+"] is not none else 0 }}</span>
                </div>
              </div>
            </div>
            <!-- Batting 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 2, 'batting_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Batting 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs</span>
                <span>{{ opp_order_stats[2]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Strike Rate</span>
                <span>{{ opp_order_stats[2]["Lower Order"]["sr"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">30+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["30+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">50+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["50+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">100+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["100+"] }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  {% elif view_type == 'bowling' %}

  <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
    <button id="downloadOrderPDFBowling" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download PDF
    </button>
    <div class="flex-1 min-w-[400px]">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
        <div class="flex items-start gap-3">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
            <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
              Click on order card to view detailed match stats and download.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- ========== SPLIT INNING WISE MATCH DISTRIBUTION (BOWLING) ========== -->
  <div id="orderPDFBowlingContent">
    <div class="col-span-12 mt-6">
      <div class="card">
        <div class="card-body grid grid-cols-1 md:grid-cols-2 gap-8">
          <!-- Left: Selected Team -->
          <div class="flex flex-col items-center w-full">
            <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
              Inning Wise <br> Match Distribution<br>
              <span class="text-xl font-semibold text-custom-500">({{ selected_team }})</span>
            </h2>
            <div class="flex flex-col gap-4 w-full">
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 1st</span>
                <span class="font-extrabold text-green-400" style="font-size:60px;">{{ bowling_first_count }}</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 2nd</span>
                <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ bowling_second_count }}</span>
              </div>
            </div>
          </div>
          <!-- Right: Opponent Teams Against Us -->
          <div class="flex flex-col items-center w-full">
            <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-2">
              Inning Wise <br> Match Distribution<br>
              <span class="text-xl font-semibold text-red-500">(Opponents)</span>
            </h2>
            <div class="flex flex-col gap-4 w-full">
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 1st</span>
                <span class="font-extrabold text-green-400" style="font-size:60px;">{{ opp_bowling_first_count }}</span>
              </div>
              <div class="flex flex-col items-center">
                <span class="text-xl font-medium text-slate-700 dark:text-slate-300 mb-1">Bowling 2nd</span>
                <span class="font-extrabold text-orange-400" style="font-size:60px;">{{ opp_bowling_second_count }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

<script>
// Order Wise Bowling PDF Download (all order cards: Inning Wise, Top, Middle, Lower)
document.addEventListener("DOMContentLoaded", function () {
  var btn = document.getElementById('downloadOrderPDFBowling');
  if (!btn) return;
  btn.addEventListener('click', async function() {
    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
    // Select all order cards (all direct children with class col-span-12)
    const cards = document.querySelectorAll('#orderPDFBowlingContent > .col-span-12');
    if (!cards.length) return;
    btn.disabled = true;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
    try {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
      const pdfWidth = 297;
      const pdfHeight = 210;
      const margin = 10;
      const contentWidth = pdfWidth - (2 * margin);
      const contentHeight = pdfHeight - (2 * margin);
      for (let i = 0; i < cards.length; i++) {
        const card = cards[i];
        const canvas = await html2canvas(card, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: backgroundColor,
          windowWidth: card.scrollWidth,
          windowHeight: card.scrollHeight
        });
        const imgData = canvas.toDataURL('image/jpeg', 0.98);
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const widthRatio = contentWidth / (imgWidth * 0.264583);
        const heightRatio = contentHeight / (imgHeight * 0.264583);
        const ratio = Math.min(widthRatio, heightRatio);
        const scaledWidth = (imgWidth * 0.264583) * ratio;
        const scaledHeight = (imgHeight * 0.264583) * ratio;
        const xPos = margin + (contentWidth - scaledWidth) / 2;
        const yPos = margin + (contentHeight - scaledHeight) / 2;
        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
      }
      const now = new Date();
      const filename = `Order_Wise_Bowling_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
      pdf.save(filename);
    } catch (error) {
      console.error('PDF generation error:', error);
      alert('Error generating PDF. Please try again.');
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  });
});
</script>

  <!-- ========================== TOP ORDER (BOWLING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="powerplay-title text-2xl font-bold text-center tracking-wide">Top Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT SIDE: OUR TEAM (BOWLING) -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-purple-400 mb-2">Top Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 1, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[1]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[1]["Top Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Top Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 2, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[2]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[2]["Top Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Top Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT SIDE: OPPONENTS (BOWLING) -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-purple-400 mb-2">Top Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 1, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[1]["Top Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[1]["Top Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Top Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Top Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Top Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Top Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('top', 2, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[2]["Top Order"]["avg_runs"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["avg_runs"] is not none else '-' }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[2]["Top Order"]["econ"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["econ"] is not none else '-' }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["Dots"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["Dots"] is not none else '-' }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Top Order"]["Wkts"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["Wkts"] is not none else '-' }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Top Order"]["4s"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["4s"] is not none else '-' }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Top Order"]["6s"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["6s"] is not none else '-' }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["2W+"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["2W+"] is not none else '-' }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["3W+"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["3W+"] is not none else '-' }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Top Order"]["5W+"] if opp_order_stats and opp_order_stats[2] and opp_order_stats[2]["Top Order"] and opp_order_stats[2]["Top Order"]["5W+"] is not none else '-' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== MIDDLE ORDER (BOWLING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="middle-title text-2xl font-bold text-center tracking-wide">Middle Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT: Our Team -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-blue-400 mb-2">Middle Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 1, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[1]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[1]["Middle Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Middle Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 2, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[2]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[2]["Middle Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Middle Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT: Opponents -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-blue-400 mb-2">Middle Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 1, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[1]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[1]["Middle Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Middle Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('middle', 2, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[2]["Middle Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[2]["Middle Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Middle Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Middle Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========================== LOWER ORDER (BOWLING) ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-10">
        <h2 class="slog-title text-2xl font-bold text-center tracking-wide">Lower Order</h2>
        <div class="grid grid-cols-2 gap-10 w-full">
          <!-- LEFT: Our Team -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-pink-400 mb-2">Lower Order<br><span class="text-base text-blue-400">({{ selected_team }})</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 1, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[1]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[1]["Lower Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[1]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[1]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[1]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[1]["Lower Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 2, 'bowling')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ order_stats[2]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ order_stats[2]["Lower Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ order_stats[2]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ order_stats[2]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ order_stats[2]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ order_stats[2]["Lower Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
          </div>
          <!-- RIGHT: Opponents -->
          <div class="flex flex-col w-full gap-6">
            <h3 class="text-xl font-bold text-center text-pink-400 mb-2">Lower Order<br><span class="text-base text-red-400">(Opponents)</span></h3>
            <!-- Bowling 1st -->
            <div class="card bg-slate-800/40 border border-green-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 1, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-green-300 text-center mb-2">Bowling 1st</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[1]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[1]["Lower Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[1]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[1]["Lower Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
            <!-- Bowling 2nd -->
            <div class="card bg-slate-800/40 border border-yellow-400 p-4 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openOrderModal('lower', 2, 'bowling_opponent')" title="Click on order card to view detailed match stats and download.">
              <h4 class="text-lg font-bold text-yellow-300 text-center mb-2">Bowling 2nd</h4>
              <div class="flex justify-between text-gray-200 font-semibold text-base">
                <span>Avg Runs Conceded</span>
                <span>{{ opp_order_stats[2]["Lower Order"]["avg_runs"] }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-base mt-1">
                <span>Economy</span>
                <span>{{ opp_order_stats[2]["Lower Order"]["econ"] }}</span>
              </div>
              <hr class="my-3 border-gray-600">
              <div class="flex justify-between w-full mt-2">
                <div class="w-1/4 text-center">
                  <span class="text-sm">Dots</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["Dots"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Wickets</span>
                  <span class="block text-xl font-bold text-red-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["Wkts"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Fours</span>
                  <span class="block text-xl font-bold text-green-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["4s"] }}</span>
                </div>
                <div class="w-1/4 text-center">
                  <span class="text-sm">Sixes</span>
                  <span class="block text-xl font-bold text-orange-400 mt-1">{{ opp_order_stats[2]["Lower Order"]["6s"] }}</span>
                </div>
              </div>
              <div class="flex justify-between w-full mt-4">
                <div class="w-1/3 text-center">
                  <span class="text-sm">2W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["2W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">3W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["3W+"] }}</span>
                </div>
                <div class="w-1/3 text-center">
                  <span class="text-sm">5W+</span>
                  <span class="block text-xl font-bold mt-1">{{ opp_order_stats[2]["Lower Order"]["5W+"] }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% endif %}
  </div> <!-- End orderPDFContent -->
</div>

<!-- ================== PACE & SPIN WISE ================== -->
<div id="pace_spinWiseDiv" style="display:none;">
  {% if view_type == 'batting' %}

  <!-- PDF Download Button and Info Note -->
  <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
    <button id="downloadPaceSpinPDF" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download PDF
    </button>

    <!-- Info Note -->
    <div class="flex-1 min-w-[400px]">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
        <div class="flex items-start gap-3">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
            <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
              Click on pace or spin card to view detailed match stats and download.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="paceSpinPDFContent">
  <!-- ========================== PACE vs SPIN â€” BATTING ========================== -->
  <div class="col-span-12 mt-6">
    <div class="card">
      <div class="card-body flex flex-col items-center gap-8">

        <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight">
            Pace & Spin â€” Batting Comparison
        </h2>

        <div class="grid grid-cols-2 gap-10 w-full mt-4">

          <!-- PACE â€” left = selected team batting vs pace -->
          <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('pace', 'team', 'batting')" title="Click on pace or spin card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-3">Pace - {{ selected_team }}</h3>

            <div class="flex justify-between text-gray-200 font-semibold text-lg">
              <span>Avg Runs</span>
              <span>{{ pace_team1_avg_runs }}</span>
            </div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
              <span>Strike Rate</span>
              <span>{{ pace_team1_sr }}</span>
            </div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-4">

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Dots</span>
                <span class="block text-lg sm:text-xl font-bold mt-1">
                  {{ pace_team1_dots }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Wkts</span>
                <span class="block text-lg sm:text-xl font-bold text-red-400 mt-1">
                  {{ pace_team1_wkts }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">4s</span>
                <span class="block text-lg sm:text-xl font-bold text-green-400 mt-1">
                  {{ pace_team1_fours }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">6s</span>
                <span class="block text-lg sm:text-xl font-bold text-orange-400 mt-1">
                  {{ pace_team1_sixes }}
                </span>
              </div>

            </div>


          </div>

          <!-- PACE â€” right = opponents batting vs pace -->
          <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('pace', 'opponent', 'batting')" title="Click on pace or spin card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Pace - Opponents</h3>

            <div class="flex justify-between text-gray-200 font-semibold text-lg">
              <span>Avg Runs</span>
              <span>{{ pace_oppo_avg_runs }}</span>
            </div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
              <span>Strike Rate</span>
              <span>{{ pace_oppo_sr }}</span>
            </div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-4">

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Dots</span>
                <span class="block text-lg sm:text-xl font-bold mt-1">
                  {{ pace_oppo_dots }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Wkts</span>
                <span class="block text-lg sm:text-xl font-bold text-red-400 mt-1">
                  {{ pace_oppo_wkts }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">4s</span>
                <span class="block text-lg sm:text-xl font-bold text-green-400 mt-1">
                  {{ pace_oppo_fours }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">6s</span>
                <span class="block text-lg sm:text-xl font-bold text-orange-400 mt-1">
                  {{ pace_oppo_sixes }}
                </span>
              </div>

            </div>


          </div>
        </div>

        <!-- ===== SPIN ROW ===== -->
        <div class="grid grid-cols-2 gap-10 w-full mt-8">

          <!-- SPIN â€” left = selected team batting vs spin -->
          <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('spin', 'team', 'batting')" title="Click on pace or spin card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-green-300 text-center mb-3">Spin - {{ selected_team }}</h3>

            <div class="flex justify-between text-gray-200 font-semibold text-lg">
              <span>Avg Runs</span>
              <span>{{ spin_team1_avg_runs }}</span>
            </div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
              <span>Strike Rate</span>
              <span>{{ spin_team1_sr }}</span>
            </div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-4">

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Dots</span>
                <span class="block text-lg sm:text-xl font-bold mt-1">
                  {{ spin_team1_dots }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Wkts</span>
                <span class="block text-lg sm:text-xl font-bold text-red-400 mt-1">
                  {{ spin_team1_wkts }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">4s</span>
                <span class="block text-lg sm:text-xl font-bold text-green-400 mt-1">
                  {{ spin_team1_fours }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">6s</span>
                <span class="block text-lg sm:text-xl font-bold text-orange-400 mt-1">
                  {{ spin_team1_sixes }}
                </span>
              </div>

            </div>




            <!-- <div class="flex justify-between w-full mt-6">
              <div class="w-1/2 text-center">
                <span class="text-sm">Matches</span>
                <span class="block text-lg font-bold mt-1">{{ spin_team1_matches }}</span>
              </div>
              <div class="w-1/2 text-center">
                <span class="text-sm">Note</span>
                <span class="block text-sm mt-1">Avg per match</span>
              </div>
            </div> -->
          </div>

          <!-- SPIN â€” right = opponents batting vs spin -->
          <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('spin', 'opponent', 'batting')" title="Click on pace or spin card to view detailed match stats and download.">
            <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Spin - Opponents</h3>

            <div class="flex justify-between text-gray-200 font-semibold text-lg">
              <span>Avg Runs</span>
              <span>{{ spin_oppo_avg_runs }}</span>
            </div>
            <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
              <span>Strike Rate</span>
              <span>{{ spin_oppo_sr }}</span>
            </div>

            <hr class="my-4 border-gray-600">

            <div class="flex justify-between w-full mt-4">

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Dots</span>
                <span class="block text-lg sm:text-xl font-bold mt-1">
                  {{ spin_oppo_dots }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">Wkts</span>
                <span class="block text-lg sm:text-xl font-bold text-red-400 mt-1">
                  {{ spin_oppo_wkts }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">4s</span>
                <span class="block text-lg sm:text-xl font-bold text-green-400 mt-1">
                  {{ spin_oppo_fours }}
                </span>
              </div>

              <div class="w-1/4 text-center">
                <span class="text-base sm:text-lg text-gray-300">6s</span>
                <span class="block text-lg sm:text-xl font-bold text-orange-400 mt-1">
                  {{ spin_oppo_sixes }}
                </span>
              </div>

            </div>


          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

  {% elif view_type == 'bowling' %}

  <!-- ========================== PACE vs SPIN â€” BOWLING ========================== -->
  <div class="col-span-12 mt-6 flex flex-wrap items-center gap-4">
    <button id="downloadPaceSpinPDFBowling" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download PDF
    </button>
    <div class="flex-1 min-w-[400px]">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg p-4 shadow-md">
        <div class="flex items-start gap-3">
          <svg class="w-7 h-7 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <div>
            <h4 class="text-2xl font-bold text-blue-800 dark:text-blue-300 mb-1">ðŸ’¡ Pro Tip</h4>
            <p class="text-xl text-blue-700 dark:text-blue-200 leading-relaxed">
              Click on pace or spin card to view detailed match stats and download.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="paceSpinPDFContentBowling">
    <div class="col-span-12 mt-6">
      <div class="card">
        <div class="card-body flex flex-col items-center gap-8">
          <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight">
              Pace & Spin â€” Bowling Comparison
          </h2>
          <div class="grid grid-cols-2 gap-10 w-full mt-4">
            <!-- ...existing code for pace bowling cards... -->
            <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('pace', 'team', 'bowling')" title="Click on pace or spin card to view detailed match stats and download.">
              <h3 class="text-xl font-bold text-green-300 text-center mb-3">Pace - {{ selected_team }} (Bowling)</h3>
              <div class="flex justify-between text-gray-200 font-semibold text-lg">
                <span>Avg Runs Conceded</span>
                <span>{{ pace_bowl_team1_runs }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
                <span>Economy</span>
                <span>{{ pace_bowl_team1_econ }}</span>
              </div>
              <hr class="my-4 border-gray-600">
              <div class="flex justify-between w-full mt-4">
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Overs</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_team1_overs }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Wd</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_team1_wd }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Nb</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_team1_nb }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Dots</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_team1_dots }}</span>
                  </div>
              </div>
              <div class="flex justify-between w-full mt-6">
                  <div class="w-1/3 text-center">
                      <span class="text-lg">Wkts</span>
                      <span class="block text-2xl font-bold text-red-400 mt-1">{{ pace_bowl_team1_wkts }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">4s</span>
                      <span class="block text-2xl font-bold text-green-400 mt-1">{{ pace_bowl_team1_fours }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">6s</span>
                      <span class="block text-2xl font-bold text-orange-400 mt-1">{{ pace_bowl_team1_sixes }}</span>
                  </div>
              </div>
            </div>
            <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('pace', 'opponent', 'bowling')" title="Click on pace or spin card to view detailed match stats and download.">
              <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Pace - Opponents (Bowling)</h3>
              <div class="flex justify-between text-gray-200 font-semibold text-lg">
                <span>Avg Runs Conceded</span>
                <span>{{ pace_bowl_oppo_runs }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
                <span>Economy</span>
                <span>{{ pace_bowl_oppo_econ }}</span>
              </div>
              <hr class="my-4 border-gray-600">
              <div class="flex justify-between w-full mt-4">
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Overs</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_oppo_overs }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Wd</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_oppo_wd }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Nb</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_oppo_nb }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Dots</span>
                      <span class="block text-2xl font-bold mt-1">{{ pace_bowl_oppo_dots }}</span>
                  </div>
              </div>
              <div class="flex justify-between w-full mt-6">
                  <div class="w-1/3 text-center">
                      <span class="text-lg">Wkts</span>
                      <span class="block text-2xl font-bold text-red-400 mt-1">{{ pace_bowl_oppo_wkts }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">4s</span>
                      <span class="block text-2xl font-bold text-green-400 mt-1">{{ pace_bowl_oppo_fours }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">6s</span>
                      <span class="block text-2xl font-bold text-orange-400 mt-1">{{ pace_bowl_oppo_sixes }}</span>
                  </div>
              </div>
            </div>
          </div>
          <!-- ===== SPIN Bowling row ===== -->
          <div class="grid grid-cols-2 gap-10 w-full mt-8">
            <div class="card bg-slate-800/40 border border-green-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('spin', 'team', 'bowling')" title="Click on pace or spin card to view detailed match stats and download.">
              <h3 class="text-xl font-bold text-green-300 text-center mb-3">Spin - {{ selected_team }} (Bowling)</h3>
              <div class="flex justify-between text-gray-200 font-semibold text-lg">
                <span>Avg Runs Conceded</span>
                <span>{{ spin_bowl_team1_runs }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
                <span>Economy</span>
                <span>{{ spin_bowl_team1_econ }}</span>
              </div>
              <hr class="my-4 border-gray-600">
              <div class="flex justify-between w-full mt-4">
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Overs</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_team1_overs }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Wd</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_team1_wd }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Nb</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_team1_nb }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Dots</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_team1_dots }}</span>
                  </div>
              </div>
              <div class="flex justify-between w-full mt-6">
                  <div class="w-1/3 text-center">
                      <span class="text-lg">Wkts</span>
                      <span class="block text-2xl font-bold text-red-400 mt-1">{{ spin_bowl_team1_wkts }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">4s</span>
                      <span class="block text-2xl font-bold text-green-400 mt-1">{{ spin_bowl_team1_fours }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">6s</span>
                      <span class="block text-2xl font-bold text-orange-400 mt-1">{{ spin_bowl_team1_sixes }}</span>
                  </div>
              </div>
            </div>
            <div class="card bg-slate-800/40 border border-yellow-400 p-6 rounded-xl shadow-xl cursor-pointer hover:shadow-2xl hover:scale-105 transition-all duration-300" onclick="openPaceSpinModal('spin', 'opponent', 'bowling')" title="Click on pace or spin card to view detailed match stats and download.">
              <h3 class="text-xl font-bold text-yellow-300 text-center mb-3">Spin - Opponents (Bowling)</h3>
              <div class="flex justify-between text-gray-200 font-semibold text-lg">
                <span>Avg Runs Conceded</span>
                <span>{{ spin_bowl_oppo_runs }}</span>
              </div>
              <div class="flex justify-between text-gray-200 font-semibold text-lg mt-2">
                <span>Economy</span>
                <span>{{ spin_bowl_oppo_econ }}</span>
              </div>
              <hr class="my-4 border-gray-600">
              <div class="flex justify-between w-full mt-4">
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Overs</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_oppo_overs }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Wd</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_oppo_wd }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Nb</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_oppo_nb }}</span>
                  </div>
                  <div class="w-1/4 text-center">
                      <span class="text-lg">Dots</span>
                      <span class="block text-2xl font-bold mt-1">{{ spin_bowl_oppo_dots }}</span>
                  </div>
              </div>
              <div class="flex justify-between w-full mt-6">
                  <div class="w-1/3 text-center">
                      <span class="text-lg">Wkts</span>
                      <span class="block text-2xl font-bold text-red-400 mt-1">{{ spin_bowl_oppo_wkts }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">4s</span>
                      <span class="block text-2xl font-bold text-green-400 mt-1">{{ spin_bowl_oppo_fours }}</span>
                  </div>
                  <div class="w-1/3 text-center">
                      <span class="text-lg">6s</span>
                      <span class="block text-2xl font-bold text-orange-400 mt-1">{{ spin_bowl_oppo_sixes }}</span>
                  </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  {% endif %}
  </div> <!-- End paceSpinPDFContent -->



<!-- ================== AREA WISE (ONLY INNING WISE DISTRIBUTION) ================== -->
<style>
    /* Increase checkbox + label size for Area Wise tab */
    .area-filter-checkbox {
        width: 22px !important;
        height: 22px !important;
        transform: scale(1.15);
        margin-right: 6px;
        cursor: pointer;
    }

    .area-filter-label {
        font-size: 20px !important; /* increased from ~18 â†’ 20 */
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 4px;
    }
</style>


<div id="areaWiseDiv" style="display:none;">
  {% if view_type == 'batting' %}
    <div class="col-span-12 mt-6 flex justify-start">
      <button id="downloadAreaWisePDF" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        Download PDF
      </button>
    </div>

    <div id="areaWisePDFContent">
      <div class="col-span-12 mt-10">
          <div class="card">
              <div class="card-body">
                  <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-6">
                      Area Wise â€” {{ selected_team }} vs Opponent Wagon
                  </h2>
                  <!-- ======================== WAGON RADARS ======================== -->
                  <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                      <!-- LEFT (TEAM) -->
                      <div class="flex flex-col items-center">
                          <div id="team_title" class="font-semibold text-xl text-slate-700 dark:text-slate-300 mb-3">
                              {{ selected_team }}
                          </div>

                          <img id="team_wagon_img" src="{{ team_radar_b64 or '' }}" style="width:520px;height:520px;object-fit:contain;"/>
                          <!-- TEAM CHECKBOXES -->
                          <div id="t1_checkboxes" class="flex gap-4 mt-4 text-slate-200">
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="all" checked> All
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="1"> 1s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="2"> 2s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="3"> 3s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="4"> 4s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="6"> 6s
                              </label>
                          </div>
                      </div>
                    

                      <!-- RIGHT (OPPONENT) -->
                      <div class="flex flex-col items-center">
                          <div id="oppo_title" class="font-semibold text-xl text-slate-700 dark:text-slate-300 mb-3">
                              {{ opponent_name }}
                          </div>

                          <img id="oppo_wagon_img"
                               src="{{ opponent_radar_b64 or '' }}"
                               style="width:520px;height:520px;object-fit:contain;" />

                          <!-- OPPONENT CHECKBOXES -->
                          <div id="t2_checkboxes" class="flex gap-4 mt-4 text-slate-200">
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="all" checked> All
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="1"> 1s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="2"> 2s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="3"> 3s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="4"> 4s
                              </label>
                              <label class="area-filter-label">
                                  <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="6"> 6s
                              </label>
                          </div>
                      </div>
                  </div>

                  <!-- ======================== AREA WISE TABLES ======================== -->
                  <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mt-12">

                      <!-- ================= TEAM AREA TABLE ================= -->
                      <div class="card bg-white dark:bg-zink-800 shadow-md rounded-lg">
                        <div class="card-body">

                          <h3 class="text-2xl font-bold mb-4 text-center text-custom-500">
                              {{ selected_team }} â€” {{ view_type|title }}
                          </h3>

                          <div class="overflow-x-auto">
                            <table class="w-full text-xl bg-custom-50 dark:bg-custom-500/10">
                              <thead class="bg-custom-100 dark:bg-custom-500/10 text-xl">
                                <tr>
                                  <th class="px-2 py-1.5 text-center">Area</th>
                                  <th class="px-2 py-1.5 text-center">Runs</th>
                                  <th class="px-2 py-1.5 text-center">Balls</th>

                                  {% if view_type == 'batting' %}
                                    <th class="px-2 py-1.5 text-center">S/R</th>
                                  {% else %}
                                    <th class="px-2 py-1.5 text-center">Eco</th>
                                  {% endif %}

                                  <th class="px-2 py-1.5 text-center">Dots</th>
                                  <th class="px-2 py-1.5 text-center">1s</th>
                                  <th class="px-2 py-1.5 text-center">2s</th>
                                  <th class="px-2 py-1.5 text-center">3s</th>
                                  <th class="px-2 py-1.5 text-center">4s</th>
                                  <th class="px-2 py-1.5 text-center">6s</th>
                                  <th class="px-2 py-1.5 text-center">Bdry%</th>
                                  <th class="px-2 py-1.5 text-center">Runs%</th>
                                </tr>
                              </thead>

                              <tbody class="text-xl">
                                {% set rows = team_area_batting if view_type=='batting' else team_area_bowling %}
                                {% for r in rows %}
                                <tr>
                                  <td class="text-center">{{ r.Area }}</td>
                                  <td class="text-center">{{ r.Runs }}</td>
                                  <td class="text-center">{{ r.Balls }}</td>

                                  {% if view_type == 'batting' %}
                                    <td class="text-center">{{ r.SR }}</td>
                                  {% else %}
                                    <td class="text-center">{{ r.Eco }}</td>
                                  {% endif %}

                                  <td class="text-center">{{ r.Dots }}</td>
                                  <td class="text-center">{{ r['1s'] }}</td>
                                  <td class="text-center">{{ r['2s'] }}</td>
                                  <td class="text-center">{{ r['3s'] }}</td>
                                  <td class="text-center">{{ r['4s'] }}</td>
                                  <td class="text-center">{{ r['6s'] }}</td>
                                  <td class="text-center">{{ r.BdryPct }}%</td>
                                  <td class="text-center">{{ r.RunsPct }}%</td>
                                </tr>
                                {% endfor %}
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>

                      <!-- ================= OPPONENT AREA TABLE ================= -->
                      <div class="card bg-white dark:bg-zink-800 shadow-md rounded-lg">
                        <div class="card-body">

                          <h3 class="text-2xl font-bold mb-4 text-center text-custom-600">
                              {{ opponent_name }} â€” {{ view_type|title }}
                          </h3>

                          <div class="overflow-x-auto">
                            <table class="w-full text-xl bg-custom-50 dark:bg-custom-500/10">
                              <thead class="bg-custom-100 dark:bg-custom-500/10 text-xl">
                                <tr>
                                  <th class="px-2 py-1.5 text-center">Area</th>
                                  <th class="px-2 py-1.5 text-center">Runs</th>
                                  <th class="px-2 py-1.5 text-center">Balls</th>

                                  {% if view_type == 'batting' %}
                                    <th class="px-2 py-1.5 text-center">S/R</th>
                                  {% else %}
                                    <th class="px-2 py-1.5 text-center">Eco</th>
                                  {% endif %}

                                  <th class="px-2 py-1.5 text-center">Dots</th>
                                  <th class="px-2 py-1.5 text-center">1s</th>
                                  <th class="px-2 py-1.5 text-center">2s</th>
                                  <th class="px-2 py-1.5 text-center">3s</th>
                                  <th class="px-2 py-1.5 text-center">4s</th>
                                  <th class="px-2 py-1.5 text-center">6s</th>
                                  <th class="px-2 py-1.5 text-center">Bdry%</th>
                                  <th class="px-2 py-1.5 text-center">Runs%</th>
                                </tr>
                              </thead>

                              <tbody class="text-xl">
                                {% set rows = oppo_area_batting if view_type=='batting' else oppo_area_bowling %}
                                {% for r in rows %}
                                <tr>
                                  <td class="text-center">{{ r.Area }}</td>
                                  <td class="text-center">{{ r.Runs }}</td>
                                  <td class="text-center">{{ r.Balls }}</td>

                                  {% if view_type == 'batting' %}
                                    <td class="text-center">{{ r.SR }}</td>
                                  {% else %}
                                    <td class="text-center">{{ r.Eco }}</td>
                                  {% endif %}

                                  <td class="text-center">{{ r.Dots }}</td>
                                  <td class="text-center">{{ r['1s'] }}</td>
                                  <td class="text-center">{{ r['2s'] }}</td>
                                  <td class="text-center">{{ r['3s'] }}</td>
                                  <td class="text-center">{{ r['4s'] }}</td>
                                  <td class="text-center">{{ r['6s'] }}</td>
                                  <td class="text-center">{{ r.BdryPct }}%</td>
                                  <td class="text-center">{{ r.RunsPct }}%</td>
                                </tr>
                                {% endfor %}
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
    </div> <!-- End areaWisePDFContent -->
  {% elif view_type == 'bowling' %}
    <div>
      <div class="col-span-12 mt-6 flex justify-start">
        <button id="downloadAreaWisePDFBowling" class="inline-flex items-center gap-2 px-6 py-3 text-lg font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Download PDF
        </button>
      </div>
      <div id="areaWisePDFContentBowling">
        <div class="col-span-12 mt-10">
          <div class="card">
            <div class="card-body">
              <h2 class="text-2xl font-bold text-center text-slate-700 dark:text-slate-200 tracking-wide leading-tight mb-6">
                Area Wise - {{ selected_team }} vs Opponent Wagon
              </h2>
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                <!-- LEFT (Selected Team Bowling Wagon) -->
                <div class="flex flex-col items-center">
                  <div id="team_title_bowling" class="font-semibold text-xl text-slate-700 dark:text-slate-300 mb-3">
                    {{ selected_team }}
                  </div>
                  <img id="team_wagon_img_bowling" src="{{ team_radar_b64 or '' }}" style="width:520px;height:520px;object-fit:contain;" />
                  <div id="t1_checkboxes_bowling" class="flex gap-4 mt-4 text-slate-200">
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="all" checked> All
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="1"> 1s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="2"> 2s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="3"> 3s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="4"> 4s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t1_runs" value="6"> 6s
                    </label>
                  </div>
                </div>
                <!-- RIGHT (All Opponents Batting Wagon) -->
                <div class="flex flex-col items-center">
                  <div id="oppo_title_bowling" class="font-semibold text-xl text-slate-700 dark:text-slate-300 mb-3">
                    All Opponents
                  </div>
                  <img id="oppo_wagon_img_bowling" src="{{ opponent_radar_b64 or '' }}" style="width:520px;height:520px;object-fit:contain;" />
                  <div id="t2_checkboxes_bowling" class="flex gap-4 mt-4 text-slate-200">
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="all" checked> All
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="1"> 1s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="2"> 2s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="3"> 3s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="4"> 4s
                    </label>
                    <label class="area-filter-label">
                      <input type="checkbox" class="area-filter-checkbox" name="t2_runs" value="6"> 6s
                    </label>
                  </div>
                </div>
              </div>
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 mt-12">
                <!-- Selected Team Table (Runs Conceded by {{ selected_team }}) -->
                <div class="card bg-white dark:bg-zink-800 shadow-md rounded-lg">
                  <div class="card-body">
                    <h3 class="text-2xl font-bold mb-4 text-center text-custom-600">
                      {{ selected_team }} â€” Bowling
                    </h3>
                    <div class="overflow-x-auto">
                      <table class="w-full text-xl bg-custom-50 dark:bg-custom-500/10">
                        <thead class="bg-custom-100 dark:bg-custom-500/10 text-xl">
                          <tr>
                            <th class="px-2 py-1.5 text-center">Area</th>
                            <th class="px-2 py-1.5 text-center">Runs</th>
                            <th class="px-2 py-1.5 text-center">Balls</th>
                            <th class="px-2 py-1.5 text-center">Eco</th>
                            <th class="px-2 py-1.5 text-center">Dots</th>
                            <th class="px-2 py-1.5 text-center">1s</th>
                            <th class="px-2 py-1.5 text-center">2s</th>
                            <th class="px-2 py-1.5 text-center">3s</th>
                            <th class="px-2 py-1.5 text-center">4s</th>
                            <th class="px-2 py-1.5 text-center">6s</th>
                            <th class="px-2 py-1.5 text-center">Bdry%</th>
                            <th class="px-2 py-1.5 text-center">Runs%</th>
                          </tr>
                        </thead>
                        <tbody class="text-xl">
                          {% set rows = team_area_bowling %}
                          {% for r in rows %}
                          <tr>
                            <td class="text-center">{{ r.Area }}</td>
                            <td class="text-center">{{ r.Runs }}</td>
                            <td class="text-center">{{ r.Balls }}</td>
                            <td class="text-center">{{ r.Eco }}</td>
                            <td class="text-center">{{ r.Dots }}</td>
                            <td class="text-center">{{ r['1s'] }}</td>
                            <td class="text-center">{{ r['2s'] }}</td>
                            <td class="text-center">{{ r['3s'] }}</td>
                            <td class="text-center">{{ r['4s'] }}</td>
                            <td class="text-center">{{ r['6s'] }}</td>
                            <td class="text-center">{{ r.BdryPct }}%</td>
                            <td class="text-center">{{ r.RunsPct }}%</td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <!-- All Opponents Table (Runs Scored by Opponents vs {{ selected_team }}) -->
                <div class="card bg-white dark:bg-zink-800 shadow-md rounded-lg">
                  <div class="card-body">
                    <h3 class="text-2xl font-bold mb-4 text-center text-custom-500">
                       All Opponents â€” Bowling
                    </h3>
                    <div class="overflow-x-auto">
                      <table class="w-full text-xl bg-custom-50 dark:bg-custom-500/10">
                        <thead class="bg-custom-100 dark:bg-custom-500/10 text-xl">
                          <tr>
                            <th class="px-2 py-1.5 text-center">Area</th>
                            <th class="px-2 py-1.5 text-center">Runs</th>
                            <th class="px-2 py-1.5 text-center">Balls</th>
                            <th class="px-2 py-1.5 text-center">Eco</th>
                            <th class="px-2 py-1.5 text-center">Dots</th>
                            <th class="px-2 py-1.5 text-center">1s</th>
                            <th class="px-2 py-1.5 text-center">2s</th>
                            <th class="px-2 py-1.5 text-center">3s</th>
                            <th class="px-2 py-1.5 text-center">4s</th>
                            <th class="px-2 py-1.5 text-center">6s</th>
                            <th class="px-2 py-1.5 text-center">Bdry%</th>
                            <th class="px-2 py-1.5 text-center">Runs%</th>
                          </tr>
                        </thead>
                        <tbody class="text-xl">
                          {% set rows = oppo_area_bowling %}
                          {% for r in rows %}
                          <tr>
                            <td class="text-center">{{ r.Area }}</td>
                            <td class="text-center">{{ r.Runs }}</td>
                            <td class="text-center">{{ r.Balls }}</td>
                            <td class="text-center">{{ r.Eco }}</td>
                            <td class="text-center">{{ r.Dots }}</td>
                            <td class="text-center">{{ r['1s'] }}</td>
                            <td class="text-center">{{ r['2s'] }}</td>
                            <td class="text-center">{{ r['3s'] }}</td>
                            <td class="text-center">{{ r['4s'] }}</td>
                            <td class="text-center">{{ r['6s'] }}</td>
                            <td class="text-center">{{ r.BdryPct }}%</td>
                            <td class="text-center">{{ r.RunsPct }}%</td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  {% endif %}
</div>


<script>
/* ===================================
   Helper: return checked values
=================================== */
function gatherCheckedValues(selector) {
    const cont = document.querySelector(selector);
    if (!cont) return [];
    return [...cont.querySelectorAll("input[type='checkbox']:checked")]
        .map(cb => cb.value);
}

/* ===================================
   Debounce
=================================== */
function debounce(fn, delay = 120) {
    let t;
    return function (...args) {
        clearTimeout(t);
        t = setTimeout(() => fn.apply(this, args), delay);
    };
}

/* ===================================
   UPDATE RADAR IMAGES
=================================== */
async function updateTeamWagon() {

    const selected_team = "{{ selected_team }}";
    const selected_matches = {{ (selected_matches or [])|tojson|safe }};
    const view_type = "{{ view_type }}";

    // Batting Area Wise
    const t1 = gatherCheckedValues("#t1_checkboxes");
    const t2 = gatherCheckedValues("#t2_checkboxes");

    // Bowling Area Wise
    const t1_bowling = gatherCheckedValues("#t1_checkboxes_bowling");
    const t2_bowling = gatherCheckedValues("#t2_checkboxes_bowling");

    // Batting tab update
    if (document.getElementById("team_wagon_img") && document.getElementById("oppo_wagon_img")) {
      const payload = {
        selected_team,
        selected_matches,
        view_type: 'batting',
        t1_run_filter: t1,
        t2_run_filter: t2
      };
      try {
        const res = await fetch("/apps/api/team_wagon_filter", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(payload)
        });
        const j = await res.json();
        if (j.team_img) {
          document.getElementById("team_wagon_img").src = j.team_img;
        }
        if (j.opponent_img) {
          document.getElementById("oppo_wagon_img").src = j.opponent_img;
        }
      } catch (e) {
        console.error("updateTeamWagon failed:", e);
      }
    }

    // Bowling tab update
    if (document.getElementById("team_wagon_img_bowling") && document.getElementById("oppo_wagon_img_bowling")) {
      const payload = {
        selected_team,
        selected_matches,
        view_type: 'bowling',
        t1_run_filter: t1_bowling,
        t2_run_filter: t2_bowling
      };
      try {
        const res = await fetch("/apps/api/team_wagon_filter", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(payload)
        });
        const j = await res.json();
        if (j.team_img) {
          document.getElementById("team_wagon_img_bowling").src = j.team_img;
        }
        if (j.opponent_img) {
          document.getElementById("oppo_wagon_img_bowling").src = j.opponent_img;
        }
      } catch (e) {
        console.error("updateTeamWagon (bowling) failed:", e);
      }
    }
}

/* ===================================
   Checkbox Logic â€” TRUE MULTISELECT
=================================== */
function initTeamWagonCheckboxes() {

    ["t1_checkboxes", "t2_checkboxes", "t1_checkboxes_bowling", "t2_checkboxes_bowling"].forEach(id => {

        const box = document.getElementById(id);
        if (!box) return;

        const allBox = box.querySelector('input[value="all"]');
        const others = [...box.querySelectorAll("input[type='checkbox']")]
                        .filter(cb => cb.value !== "all");

        // Handler for each checkbox
        const handleChange = debounce((event) => {
            const clickedCheckbox = event.target;

            /* ----------------------------
               CASE 1 â†’ User clicked ALL
               ---------------------------- */
            if (clickedCheckbox.value === "all" && clickedCheckbox.checked) {
                others.forEach(cb => cb.checked = false);
            } 
            /* ----------------------------
               CASE 2 â†’ User clicked a specific run filter (1s, 2s, etc.)
               ---------------------------- */
            else if (clickedCheckbox.value !== "all") {
                // Uncheck ALL when any specific filter is selected
                if (clickedCheckbox.checked) {
                    allBox.checked = false;
                }
                // If all specific filters are unchecked, check ALL
                else if (!others.some(cb => cb.checked)) {
                    allBox.checked = true;
                }
            }

            updateTeamWagon();
        }, 120);

        // Add event listener to all checkboxes
        [...box.querySelectorAll("input[type='checkbox']")].forEach(cb => {
          cb.addEventListener("change", handleChange);
        });
    });
}

/* ===================================
   Initialize on page load
=================================== */
document.addEventListener("DOMContentLoaded", initTeamWagonCheckboxes);
</script>



<div id="graphsDiv" style="display:none;">
      <div class="col-span-12 mt-6">
        <div class="card">
            <div class="card-body">
                <!-- Runs Per Over Chart -->
                <div class="w-full">
                    {{ runs_per_over_chart | safe }}
                </div>
            </div>
        </div>
    </div>

    <div class="col-span-12 mt-6">
        <div class="card">
            <div class="card-body">
                <div class="w-full">
                    {{ run_rate_chart | safe }}
                </div>
            </div>
        </div>
    </div>
</div>


{% endif %}

<!-- <script>
document.getElementById("toggle-filter-btn").onclick = () => {
  document.getElementById("filter-section").classList.toggle("hidden");
  document.getElementById("filter-arrow").classList.toggle("rotate-180");
};

function switchDistributionTab(tab) {

  const tabs = ['phase', 'order', 'area', 'pace_spin', 'graphs'];

  tabs.forEach(function(t) {

    const btn = document.getElementById('tab-' + t);
    const div = document.getElementById(t + (t === 'graphs' ? 'Div' : 'WiseDiv'));

    if (!btn || !div) return;

    if (t === tab) {

      div.style.display = 'block';

      btn.classList.add(
        'text-custom-600',
        'border-custom-500',
        'dark:text-custom-300',
        'dark:border-custom-400'
      );
      btn.classList.remove(
        'text-slate-500',
        'border-transparent',
        'dark:text-zink-300'
      );

    } else {
      div.style.display = 'none';

      btn.classList.remove(
        'text-custom-600',
        'border-custom-500',
        'dark:text-custom-300',
        'dark:border-custom-400'
      );
      
      btn.classList.add(
        'text-slate-500',
        'border-transparent',
        'dark:text-zink-300'
      );
    }
  });
}

document.addEventListener("DOMContentLoaded", function () {
  switchDistributionTab('phase');
});
</script> -->

<script>
document.getElementById("toggle-filter-btn").onclick = () => {
  document.getElementById("filter-section").classList.toggle("hidden");
  document.getElementById("filter-arrow").classList.toggle("rotate-180");
};

function resizePlotlyCharts() {
    const graphsDiv = document.getElementById("graphsDiv");
    if (graphsDiv && graphsDiv.style.display !== "none") {
        const plots = graphsDiv.getElementsByClassName("js-plotly-plot");
        for (let p of plots) {
            Plotly.Plots.resize(p);
        }
    }
}

function switchDistributionTab(tab) {

  const tabs = ['phase', 'order', 'area', 'pace_spin', 'graphs'];

  tabs.forEach(function(t) {

    const btn = document.getElementById('tab-' + t);
    const div = document.getElementById(t + (t === 'graphs' ? 'Div' : 'WiseDiv'));

    if (!btn || !div) return;

    if (t === tab) {

      div.style.display = 'block';

      if (tab === 'graphs') {
        setTimeout(resizePlotlyCharts, 100);
      }

      btn.classList.add('text-custom-600', 'border-custom-500',
                        'dark:text-custom-300', 'dark:border-custom-400');
      btn.classList.remove('text-slate-500', 'border-transparent',
                           'dark:text-zink-300');

    } else {
      div.style.display = 'none';

      btn.classList.remove('text-custom-600', 'border-custom-500',
                           'dark:text-custom-300', 'dark:border-custom-400');
      btn.classList.add('text-slate-500', 'border-transparent',
                        'dark:text-zink-300');
    }
  });
}

document.addEventListener("DOMContentLoaded", function () {
  switchDistributionTab('phase');
});
</script>

<!-- ========================== PHASE DETAIL MODAL ========================== -->
<!-- ========================== PHASE DETAIL MODAL ========================== -->
<div id="phaseDetailModal" class="hidden fixed inset-0 z-[9999] overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">

    <!-- Background overlay -->
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 dark:bg-opacity-90 transition-opacity"
         aria-hidden="true" onclick="closePhaseModal()"></div>

    <!-- Modal panel -->
    <div class="inline-block align-bottom bg-white dark:bg-zink-800 rounded-lg text-left overflow-hidden 
                shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full">

      <!-- Header -->
      <div class="bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-700 dark:to-pink-700 
                  px-6 py-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
          <h3 class="text-2xl font-bold text-white" id="modalTitle">Phase Details</h3>
          <button id="downloadModalPDF" class="inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-lg transition-all duration-300">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Download PDF
          </button>
        </div>
        <button onclick="closePhaseModal()" class="text-white hover:text-gray-200 text-3xl font-bold leading-none">&times;</button>
      </div>

      <!-- Body -->
      <div class="bg-white dark:bg-zink-800 px-6 py-6 max-h-[70vh] overflow-y-auto" id="modalPDFContent">

        <!-- Consolidated Stats Card -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700 
                    p-6 rounded-xl shadow-lg mb-6">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 mb-4 text-center">
            Consolidated Statistics
          </h4>

          <div class="overflow-x-auto">
            <table class="w-full text-left bg-custom-50 dark:bg-custom-500/10">
              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="srEconHeader">Avg. Economy</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consDotsHeader">Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consWktsHeader">Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consFoursHeader">Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consSixesHeader">Sixes</th>
                </tr>
              </thead>

              <tbody class="text-center">
                <tr class="border-b border-slate-200 dark:border-slate-700">
                  <td class="px-4 py-3 font-bold text-lg" id="consAvgRuns">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consSrEcon">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consDots">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-red-500 dark:text-red-400" id="consWkts">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-green-500 dark:text-green-400" id="consFours">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-orange-500 dark:text-orange-400" id="consSixes">-</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>

        <!-- Match-wise Statistics -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700 rounded-xl shadow-lg">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 px-6 pt-6 pb-4">
            Match-wise Breakdown
          </h4>

          <div class="overflow-x-auto px-6 pb-6">
            <table class="w-full text-left border-collapse bg-custom-50 dark:bg-custom-500/10" id="matchWiseTable">
              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Match</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchSrEconHeader">Economy</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consDotsHeader">Avg. Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consWktsHeader">Avg. Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consFoursHeader">Avg. Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consSixesHeader">Avg. Sixes</th>
                </tr>
              </thead>

              <tbody id="matchWiseBody" class="text-center"></tbody>
            </table>
          </div>

        </div>

        <!-- Loading indicator -->
        <div id="modalLoading" class="hidden text-center py-8">
          <div class="inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-purple-500 border-r-transparent"></div>
          <p class="mt-4 text-slate-600 dark:text-slate-300">Loading data...</p>
        </div>

      </div>

    </div>
  </div>
</div>

<!-- ========================== JAVASCRIPT FOR MODAL ========================== -->
<script>
function openPhaseModal(phase, inning, viewType) {

  const tournament = document.getElementById('tournament').value;
  const team = document.getElementById('team').value;
  const actualMatchesField = document.getElementById('actualMatches');
  let selectedMatches = [];

  if (actualMatchesField && actualMatchesField.value) {
    try { selectedMatches = JSON.parse(actualMatchesField.value); } catch {}
  }

  if (!tournament || !team || selectedMatches.length === 0) {
    alert("Please select tournament, team and matches.");
    return;
  }

  document.getElementById('phaseDetailModal').classList.remove('hidden');

  const phaseNames = { pp: 'Powerplay Performance', mo: 'Middle Overs Performance', so: 'Slog Overs Performance' };
  let inningText;
  if (viewType === 'batting' || viewType === 'batting_opponent') {
    inningText = (inning === 1 ? "Batting 1st" : "Batting 2nd");
  } else {
    inningText = (inning === 1 ? "Bowling 1st" : "Bowling 2nd");
  }
  document.getElementById("modalTitle").textContent =
    `${phaseNames[phase]} - ${inningText}`;

  // Treat both 'batting' and 'batting_opponent' as batting for modal labels/headers
  const isBatting = viewType === "batting" || viewType === "batting_opponent";
  const srLabel = isBatting ? "Strike Rate" : "Economy";
  document.getElementById("srEconHeader").textContent = isBatting ? "Avg. Strike Rate" : "Avg. Economy";
  document.getElementById("matchSrEconHeader").textContent = isBatting ? "Strike Rate" : "Economy";
  // Set correct headers for consolidated stats (averages for batting only)
  if (isBatting) {
    document.getElementById("consDotsHeader").textContent = "Avg. Dots";
    document.getElementById("consWktsHeader").textContent = "Avg. Wickets";
    document.getElementById("consFoursHeader").textContent = "Avg. Fours";
    document.getElementById("consSixesHeader").textContent = "Avg. Sixes";
  } else {
    document.getElementById("consDotsHeader").textContent = "Avg. Dots";
    document.getElementById("consWktsHeader").textContent = "Avg. Wickets";
    document.getElementById("consFoursHeader").textContent = "Avg. Fours";
    document.getElementById("consSixesHeader").textContent = "Avg. Sixes";
  }
  // Set correct headers for match-wise table (counts, not averages)
  const matchWiseTable = document.getElementById("matchWiseTable");
  if (matchWiseTable) {
    const ths = matchWiseTable.querySelectorAll("thead th");
    if (ths.length >= 7) {
      ths[3].textContent = "Dots";
      ths[4].textContent = "Wickets";
      ths[5].textContent = "Fours";
      ths[6].textContent = "Sixes";
    }
  }

  document.getElementById("modalLoading").classList.remove("hidden");
  document.querySelectorAll("#phaseDetailModal .card")
    .forEach(el => el.classList.add("hidden"));

  fetch("/apps/api/get_phase_matchwise_data", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      tournament, team, matches: selectedMatches,
      phase, inning, view_type: viewType
    })
  })
  .then(r => r.json())
  .then(data => {

    document.getElementById("modalLoading").classList.add("hidden");
    document.querySelectorAll("#phaseDetailModal .card")
      .forEach(el => el.classList.remove("hidden"));

    document.getElementById("consAvgRuns").textContent = data.consolidated.avg_runs;
    // Remove % from Strike Rate if present
    let srEcon = data.consolidated.sr_or_econ;
    if (typeof srEcon === 'string' && srEcon.endsWith('%')) {
      srEcon = srEcon.slice(0, -1);
    }
    document.getElementById("consSrEcon").textContent = srEcon;
    // Always show averages for Dots, Wkts, Fours, Sixes (backend now returns averages)
    document.getElementById("consDots").textContent = data.consolidated.dots;
    document.getElementById("consWkts").textContent = data.consolidated.wkts;
    document.getElementById("consFours").textContent = data.consolidated.fours;
    document.getElementById("consSixes").textContent = data.consolidated.sixes;

    const tbody = document.getElementById("matchWiseBody");
    tbody.innerHTML = "";

    data.matchwise.forEach(match => {
      const tr = document.createElement("tr");
      tr.className = "border-b border-slate-200 dark:border-slate-700";

      // Remove % from Strike Rate if present
      let matchSrEcon = match.sr_or_econ;
      if (typeof matchSrEcon === 'string' && matchSrEcon.endsWith('%')) {
        matchSrEcon = matchSrEcon.slice(0, -1);
      }
      tr.innerHTML = `
        <td class="px-4 py-3 text-lg">${match.match}</td>
        <td class="px-4 py-3 text-lg">${match.avg_runs}</td>
        <td class="px-4 py-3 text-lg">${matchSrEcon}</td>
        <td class="px-4 py-3 text-lg">${match.dots}</td>
        <td class="px-4 py-3 text-lg text-red-500 dark:text-red-400">${match.wkts}</td>
        <td class="px-4 py-3 text-lg text-green-500 dark:text-green-400">${match.fours}</td>
        <td class="px-4 py-3 text-lg text-orange-500 dark:text-orange-400">${match.sixes}</td>
      `;

      tbody.appendChild(tr);
    });

  })
  .catch(err => alert("Error loading phase data!"));
}

function closePhaseModal() {
  document.getElementById('phaseDetailModal').classList.add('hidden');
}

// PDF Download for Modal
document.getElementById('downloadModalPDF').addEventListener('click', async function() {
  const modalContent = document.getElementById('modalPDFContent');
  const modalTitle = document.getElementById('modalTitle').textContent;
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  const btn = this;
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-4 w-4 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'landscape',
      unit: 'mm',
      format: 'a4'
    });
    
    // A4 landscape: 297mm x 210mm
    const pdfWidth = 297;
    const pdfHeight = 210;
    const margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    // Capture modal content
    const canvas = await html2canvas(modalContent, {
      scale: 2,
      useCORS: true,
      logging: false,
      backgroundColor: backgroundColor,
      width: modalContent.scrollWidth,
      height: modalContent.scrollHeight
    });
    
    const imgData = canvas.toDataURL('image/jpeg', 0.98);
    const imgWidth = canvas.width;
    const imgHeight = canvas.height;
    
    // Calculate scaling
    const imgWidthMM = imgWidth * 0.264583;
    const imgHeightMM = imgHeight * 0.264583;
    const widthRatio = contentWidth / imgWidthMM;
    const heightRatio = contentHeight / imgHeightMM;
    const ratio = Math.min(widthRatio, heightRatio);
    
    const scaledWidth = imgWidthMM * ratio;
    const scaledHeight = imgHeightMM * ratio;
    
    // Center content
    const xPos = margin + (contentWidth - scaledWidth) / 2;
    const yPos = margin;
    
    pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    
    // Generate filename
    const now = new Date();
    const sanitizedTitle = modalTitle.replace(/[^a-zA-Z0-9]/g, '_');
    const filename = `${sanitizedTitle}_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    
    pdf.save(filename);
    
  } catch (error) {
    console.error('PDF generation error:', error);
    alert('Error generating PDF. Please try again.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>




<!-- ========================== ORDER DETAIL MODAL ========================== -->
<!-- ========================== ORDER DETAIL MODAL ========================== -->
<div id="orderDetailModal" class="hidden fixed inset-0 z-[9999] overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">

    <!-- Background overlay -->
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 dark:bg-opacity-90 transition-opacity"
         aria-hidden="true" onclick="closeOrderModal()"></div>

    <!-- Modal panel -->
    <div class="inline-block align-bottom bg-white dark:bg-zink-800 rounded-lg text-left overflow-hidden 
                shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full">

      <!-- Header -->
      <div class="bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-700 dark:to-pink-700 
                  px-6 py-4 flex justify-between items-center">
        <h3 class="text-2xl font-bold text-white" id="orderModalTitle">Order Details</h3>
        <button onclick="closeOrderModal()" class="text-white hover:text-gray-200 text-3xl font-bold leading-none">&times;</button>
      </div>

      <!-- Body -->
      <div class="bg-white dark:bg-zink-800 px-6 py-6 max-h-[70vh] overflow-y-auto" id="orderModalPDFContent">

        <!-- PDF Download Button -->
        <div class="flex justify-center mb-6">
          <button id="downloadOrderModalPDF" class="inline-flex items-center gap-2 px-8 py-4 text-lg font-bold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-xl transition-all duration-300 transform hover:scale-105">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Download PDF
          </button>
        </div>

        <!-- Consolidated Stats Card -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700 
                    p-6 rounded-xl shadow-lg mb-6">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 mb-4 text-center">
            Consolidated Statistics
          </h4>

          <div class="overflow-x-auto">
            <table class="w-full text-left bg-custom-50 dark:bg-custom-500/10">
              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="orderAvgRunsLabel">Avg Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consOrderSrEconHeader">Strike Rate</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Sixes</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consOrderMilestone1Label">30+</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consOrderMilestone2Label">50+</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consOrderMilestone3Label">100+</th>
                </tr>
              </thead>

              <tbody class="text-center">
                <tr class="border-b border-slate-200 dark:border-slate-700">
                  <td class="px-4 py-3 font-bold text-lg" id="consOrderAvgRuns">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consOrderSrEcon">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consOrderDots">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-red-500 dark:text-red-400" id="consOrderWkts">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-green-500 dark:text-green-400" id="consOrderFours">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-orange-500 dark:text-orange-400" id="consOrderSixes">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-yellow-600 dark:text-yellow-400" id="consOrderMilestone1">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-amber-600 dark:text-amber-400" id="consOrderMilestone2">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-rose-600 dark:text-rose-400" id="consOrderMilestone3">-</td>
                </tr>
              </tbody>

            </table>
          </div>
        </div>

        <!-- Match-wise Breakdown -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700 rounded-xl shadow-lg">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 px-6 pt-6 pb-4">
            Match-wise Breakdown
          </h4>

          <div class="overflow-x-auto px-6 pb-6">
            <table class="w-full text-left border-collapse bg-custom-50 dark:bg-custom-500/10" id="orderMatchWiseTable">
              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Match</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchOrderAvgRunsLabel">Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchOrderSrEconHeader">Strike Rate</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Avg. Sixes</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchOrderMilestone1Header">30+</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchOrderMilestone2Header">50+</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchOrderMilestone3Header">100+</th>
                </tr>
              </thead>

              <tbody id="orderMatchWiseBody" class="text-center"></tbody>
            </table>
          </div>
        </div>

        <!-- Loading -->
        <div id="orderModalLoading" class="hidden text-center py-8">
          <div class="inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-custom-500 border-r-transparent"></div>
          <p class="mt-4 text-slate-600 dark:text-slate-300">Loading data...</p>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- ========================== JAVASCRIPT FOR ORDER MODAL ========================== -->
<script>
function openOrderModal(order, inning, viewType) {


  const tournament = document.getElementById('tournament').value;
  let team = document.getElementById('team').value;

  const actualMatchesField = document.getElementById('actualMatches');
  let selectedMatches = [];

  if (actualMatchesField && actualMatchesField.value) {
    try { selectedMatches = JSON.parse(actualMatchesField.value); } catch {}
  }

  // Determine opponent team for opponent modal
  let isOpponent = false;
  let opponentTeam = null;
  if (viewType === 'batting_opponent' || viewType === 'bowling_opponent') {
    isOpponent = true;
    // Try to infer opponent from matches (first match's opponent)
    if (selectedMatches.length > 0) {
      // Find the opponent team from the first match string (e.g., 'VCA vs TNCA')
      const matchStr = selectedMatches[0];
      const selectedTeam = team;
      if (matchStr.includes(' vs ')) {
        const [teamA, teamB] = matchStr.split(' vs ');
        opponentTeam = (teamA === selectedTeam) ? teamB : teamA;
      }
    }
    if (opponentTeam) {
      team = opponentTeam;
    }
  }

  if (!tournament || !team || selectedMatches.length === 0) {
    alert("Please select tournament, team and matches first.");
    return;
  }

  document.getElementById('orderDetailModal').classList.remove('hidden');

  const orderNames = {
    top: "Top Order Performance",
    middle: "Middle Order Performance",
    lower: "Lower Order Performance"
  };

  const isBatting = viewType === "batting" || viewType === "batting_opponent";
  const inningText = isBatting
    ? (inning === 1 ? "Batting 1st" : "Batting 2nd")
    : (inning === 1 ? "Bowling 1st" : "Bowling 2nd");

  document.getElementById("orderModalTitle").textContent =
    `${orderNames[order]} - ${inningText}`;

  // Change labels
  if (viewType === "batting" || viewType === "batting_opponent") {
    document.getElementById("orderAvgRunsLabel").textContent = "Avg Runs";
    document.getElementById("consOrderSrEconHeader").textContent = "Strike Rate";
    document.getElementById("matchOrderAvgRunsLabel").textContent = "Avg Runs";
    document.getElementById("matchOrderSrEconHeader").textContent = "Strike Rate";
    document.getElementById("consOrderMilestone1Label").textContent = "30+";
    document.getElementById("consOrderMilestone2Label").textContent = "50+";
    document.getElementById("consOrderMilestone3Label").textContent = "100+";
    document.getElementById("matchOrderMilestone1Header").textContent = "30+";
    document.getElementById("matchOrderMilestone2Header").textContent = "50+";
    document.getElementById("matchOrderMilestone3Header").textContent = "100+";
  } else {
    document.getElementById("orderAvgRunsLabel").textContent = "Avg Runs Conceded";
    document.getElementById("consOrderSrEconHeader").textContent = "Economy";
    document.getElementById("matchOrderAvgRunsLabel").textContent = "Runs Conceded";
    document.getElementById("matchOrderSrEconHeader").textContent = "Economy";
    document.getElementById("consOrderMilestone1Label").textContent = "2W+";
    document.getElementById("consOrderMilestone2Label").textContent = "3W+";
    document.getElementById("consOrderMilestone3Label").textContent = "5W+";
    document.getElementById("matchOrderMilestone1Header").textContent = "2W+";
    document.getElementById("matchOrderMilestone2Header").textContent = "3W+";
    document.getElementById("matchOrderMilestone3Header").textContent = "5W+";
  }

  document.getElementById("orderModalLoading").classList.remove("hidden");
  document.querySelectorAll("#orderDetailModal .card")
    .forEach(el => el.classList.add("hidden"));

  fetch("/apps/api/get_order_matchwise_data", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      tournament,
      team,
      matches: selectedMatches,
      order,
      inning,
      view_type: (viewType === 'batting_opponent') ? 'batting' : (viewType === 'bowling_opponent' ? 'bowling' : viewType)
    })
  })
    .then(r => r.json())
    .then(data => {

      document.getElementById("orderModalLoading").classList.add("hidden");
      document.querySelectorAll("#orderDetailModal .card")
        .forEach(el => el.classList.remove("hidden"));

      document.getElementById("consOrderAvgRuns").textContent = data.consolidated.avg_runs;
      document.getElementById("consOrderSrEcon").textContent = data.consolidated.sr_or_econ;
      document.getElementById("consOrderDots").textContent = data.consolidated.dots;
      document.getElementById("consOrderWkts").textContent = data.consolidated.wkts;
      document.getElementById("consOrderFours").textContent = data.consolidated.fours;
      document.getElementById("consOrderSixes").textContent = data.consolidated.sixes;
      document.getElementById("consOrderMilestone1").textContent = data.consolidated.milestone1;
      document.getElementById("consOrderMilestone2").textContent = data.consolidated.milestone2;
      document.getElementById("consOrderMilestone3").textContent = data.consolidated.milestone3;

      const tbody = document.getElementById("orderMatchWiseBody");
      tbody.innerHTML = "";

      data.matchwise.forEach(match => {
        const tr = document.createElement("tr");
        tr.className = `border-b border-slate-200 dark:border-slate-700`;

        tr.innerHTML = `
          <td class="px-4 py-3 text-lg">${match.match}</td>
          <td class="px-4 py-3 text-lg">${match.avg_runs}</td>
          <td class="px-4 py-3 text-lg">${match.sr_or_econ}</td>
          <td class="px-4 py-3 text-lg">${match.dots}</td>
          <td class="px-4 py-3 text-lg text-red-500 dark:text-red-400">${match.wkts}</td>
          <td class="px-4 py-3 text-lg text-green-500 dark:text-green-400">${match.fours}</td>
          <td class="px-4 py-3 text-lg text-orange-500 dark:text-orange-400">${match.sixes}</td>
          <td class="px-4 py-3 text-lg text-yellow-600 dark:text-yellow-400">${match.milestone1}</td>
          <td class="px-4 py-3 text-lg text-amber-600 dark:text-amber-400">${match.milestone2}</td>
          <td class="px-4 py-3 text-lg text-rose-600 dark:text-rose-400">${match.milestone3}</td>
        `;

        tbody.appendChild(tr);
      });

    })
    .catch(() => alert("Error loading order data!"));
}

function closeOrderModal() {
  document.getElementById("orderDetailModal").classList.add("hidden");
}

// PDF Download for Order Modal
document.getElementById('downloadOrderModalPDF').addEventListener('click', async function() {
  const modalContent = document.getElementById('orderModalPDFContent');
  const modalTitle = document.getElementById('orderModalTitle').textContent;
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  const btn = this;
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-4 w-4 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
    
    const pdfWidth = 297, pdfHeight = 210, margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    const canvas = await html2canvas(modalContent, {
      scale: 2, useCORS: true, logging: false, backgroundColor: backgroundColor,
      width: modalContent.scrollWidth, height: modalContent.scrollHeight
    });
    
    const imgData = canvas.toDataURL('image/jpeg', 0.98);
    const imgWidthMM = canvas.width * 0.264583;
    const imgHeightMM = canvas.height * 0.264583;
    const ratio = Math.min(contentWidth / imgWidthMM, contentHeight / imgHeightMM);
    const scaledWidth = imgWidthMM * ratio;
    const scaledHeight = imgHeightMM * ratio;
    const xPos = margin + (contentWidth - scaledWidth) / 2;
    const yPos = margin;
    
    pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    
    const now = new Date();
    const sanitizedTitle = modalTitle.replace(/[^a-zA-Z0-9]/g, '_');
    const filename = `${sanitizedTitle}_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    pdf.save(filename);
  } catch (error) {
    console.error('PDF error:', error);
    alert('Error generating PDF.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>


<!-- ========================== PACE/SPIN DETAIL MODAL ========================== -->
<!-- ========================== PACE/SPIN DETAIL MODAL ========================== -->
<div id="paceSpinDetailModal" class="hidden fixed inset-0 z-[9999] overflow-y-auto"
     aria-labelledby="modal-title" role="dialog" aria-modal="true">
  <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">

    <!-- Background overlay -->
    <div class="fixed inset-0 bg-gray-900 bg-opacity-75 dark:bg-opacity-90 transition-opacity"
         aria-hidden="true" onclick="closePaceSpinModal()"></div>

    <!-- Modal panel -->
    <div class="inline-block align-bottom bg-white dark:bg-zink-800 rounded-lg text-left overflow-hidden
                shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full">

      <!-- Header -->
      <div class="bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-700 dark:to-pink-700
                  px-6 py-4 flex justify-between items-center">
        <h3 class="text-2xl font-bold text-white" id="paceSpinModalTitle">Pace / Spin Details</h3>
        <button onclick="closePaceSpinModal()" class="text-white hover:text-gray-200 text-3xl font-bold">&times;</button>
      </div>

      <!-- Body -->
      <div class="bg-white dark:bg-zink-800 px-6 py-6 max-h-[70vh] overflow-y-auto" id="paceSpinModalPDFContent">

        <!-- PDF Download Button -->
        <div class="flex justify-center mb-6">
          <button id="downloadPaceSpinModalPDF" class="inline-flex items-center gap-2 px-8 py-4 text-lg font-bold text-white bg-red-500 hover:bg-red-600 rounded-lg shadow-xl transition-all duration-300 transform hover:scale-105">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Download PDF
          </button>
        </div>

        <!-- Consolidated Stats Card -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700
                    p-6 rounded-xl shadow-lg mb-6">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 mb-4 text-center">
            Consolidated Statistics
          </h4>

          <div class="overflow-x-auto">
            <table class="w-full text-left bg-custom-50 dark:bg-custom-500/10">
              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="paceSpinAvgRunsLabel">Avg Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="consPaceSpinSrEconHeader">Strike Rate</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Overs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Wd</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Nb</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Sixes</th>
                </tr>
              </thead>

              <tbody class="text-center">
                <tr class="border-b border-slate-200 dark:border-slate-700">
                  <td class="px-4 py-3 font-bold text-lg text-slate-800 dark:text-slate-100" id="consPaceSpinAvgRuns">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-slate-800 dark:text-slate-100" id="consPaceSpinSrEcon">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-slate-800 dark:text-slate-100" id="consPaceSpinOvers">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-slate-800 dark:text-slate-100" id="consPaceSpinDots">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-red-500 dark:text-red-400" id="consPaceSpinWkts">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consPaceSpinWd">-</td>
                  <td class="px-4 py-3 font-bold text-lg" id="consPaceSpinNb">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-green-500 dark:text-green-400" id="consPaceSpinFours">-</td>
                  <td class="px-4 py-3 font-bold text-lg text-orange-500 dark:text-orange-400" id="consPaceSpinSixes">-</td>
                </tr>
              </tbody>

            </table>
          </div>

        </div>

        <!-- Match-wise Statistics -->
        <div class="card bg-custom-50 dark:bg-custom-500/10 border border-slate-300 dark:border-slate-700
                    rounded-xl shadow-lg">

          <h4 class="text-xl font-bold text-slate-700 dark:text-slate-200 px-6 pt-6 pb-4">
            Match-wise Breakdown
          </h4>

          <div class="overflow-x-auto px-6 pb-6">
            <table class="w-full text-left border-collapse bg-custom-50 dark:bg-custom-500/10"
                   id="paceSpinMatchWiseTable">

              <thead class="bg-custom-100 dark:bg-custom-500/10">
                <tr>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Match</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchPaceSpinAvgRunsLabel">Runs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg" id="matchPaceSpinSrEconHeader">Strike Rate</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Overs</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Dots</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Wickets</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Wd</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Nb</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Fours</th>
                  <th class="px-4 py-3 font-semibold text-center text-lg">Sixes</th>
                </tr>
              </thead>

              <tbody id="paceSpinMatchWiseBody" class="text-center"></tbody>
            </table>
          </div>

        </div>

        <!-- Loading Indicator -->
        <div id="paceSpinModalLoading" class="hidden text-center py-8">
          <div class="inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-custom-500 border-r-transparent"></div>
          <p class="mt-4 text-slate-600 dark:text-slate-300">Loading data...</p>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- ========================== JAVASCRIPT FOR PACE/SPIN MODAL ========================== -->
<script>
function openPaceSpinModal(ballType, teamType, viewType) {

  const tournament = document.getElementById('tournament').value;
  const team = document.getElementById('team').value;

  const actualMatchesField = document.getElementById('actualMatches');
  let selectedMatches = [];

  if (actualMatchesField && actualMatchesField.value) {
    try { selectedMatches = JSON.parse(actualMatchesField.value); } catch {}
  }

  if (!tournament || !team || selectedMatches.length === 0) {
    alert("Please select tournament, team and matches.");
    return;
  }

  document.getElementById('paceSpinDetailModal').classList.remove('hidden');

  const ballTypeText = ballType === "pace" ? "Pace" : "Spin";
  const teamText = teamType === "team" ? team : "Opponents";
  const vtText = viewType === "batting" ? "Batting" : "Bowling";

  document.getElementById("paceSpinModalTitle").textContent =
    `${ballTypeText} - ${teamText} (${vtText})`;

  // Update labels for batting/bowling
  if (viewType === "batting") {
    document.getElementById("paceSpinAvgRunsLabel").textContent = "Avg Runs";
    document.getElementById("consPaceSpinSrEconHeader").textContent = "Strike Rate";
    document.getElementById("matchPaceSpinAvgRunsLabel").textContent = "Runs";
    document.getElementById("matchPaceSpinSrEconHeader").textContent = "Strike Rate";
  } else {
    document.getElementById("paceSpinAvgRunsLabel").textContent = "Avg Runs Conceded";
    document.getElementById("consPaceSpinSrEconHeader").textContent = "Economy";
    document.getElementById("matchPaceSpinAvgRunsLabel").textContent = "Runs Conceded";
    document.getElementById("matchPaceSpinSrEconHeader").textContent = "Economy";
  }

  // Show loading
  document.getElementById("paceSpinModalLoading").classList.remove("hidden");
  document.querySelectorAll("#paceSpinDetailModal .card")
    .forEach(el => el.classList.add("hidden"));

  fetch("/apps/api/get_pacespin_matchwise_data", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      tournament, team, matches: selectedMatches,
      ball_type: ballType, team_type: teamType, view_type: viewType
    })
  })
    .then(r => r.json())
    .then(data => {

      document.getElementById("paceSpinModalLoading").classList.add("hidden");
      document.querySelectorAll("#paceSpinDetailModal .card")
        .forEach(el => el.classList.remove("hidden"));

      // Consolidated stats
      document.getElementById("consPaceSpinAvgRuns").textContent = data.consolidated.avg_runs;
      document.getElementById("consPaceSpinSrEcon").textContent = data.consolidated.sr_or_econ;
      document.getElementById("consPaceSpinOvers").textContent = data.consolidated.overs;
      document.getElementById("consPaceSpinDots").textContent = data.consolidated.dots;
      document.getElementById("consPaceSpinWkts").textContent = data.consolidated.wkts;
      document.getElementById("consPaceSpinWd").textContent = data.consolidated.wd;
      document.getElementById("consPaceSpinNb").textContent = data.consolidated.nb;
      document.getElementById("consPaceSpinFours").textContent = data.consolidated.fours;
      document.getElementById("consPaceSpinSixes").textContent = data.consolidated.sixes;

      // Match-wise table
      const tbody = document.getElementById("paceSpinMatchWiseBody");
      tbody.innerHTML = "";

      data.matchwise.forEach(match => {
        const tr = document.createElement("tr");
        tr.className = "border-b border-slate-200 dark:border-slate-700";

        tr.innerHTML = `
          <td class="px-4 py-3 text-lg">${match.match}</td>
          <td class="px-4 py-3 text-lg">${match.avg_runs}</td>
          <td class="px-4 py-3 text-lg">${match.sr_or_econ}</td>
          <td class="px-4 py-3 text-lg">${match.overs}</td>
          <td class="px-4 py-3 text-lg">${match.dots}</td>
          <td class="px-4 py-3 text-lg text-red-500 dark:text-red-400">${match.wkts}</td>
          <td class="px-4 py-3 text-lg">${match.wd}</td>
          <td class="px-4 py-3 text-lg">${match.nb}</td>
          <td class="px-4 py-3 text-lg text-green-500 dark:text-green-400">${match.fours}</td>
          <td class="px-4 py-3 text-lg text-orange-500 dark:text-orange-400">${match.sixes}</td>
        `;

        tbody.appendChild(tr);
      });

    })
    .catch(() => alert("Error loading pace/spin data!"));
}

function closePaceSpinModal() {
  document.getElementById("paceSpinDetailModal").classList.add("hidden");
}

// PDF Download for Pace/Spin Modal
document.getElementById('downloadPaceSpinModalPDF').addEventListener('click', async function() {
  const modalContent = document.getElementById('paceSpinModalPDFContent');
  const modalTitle = document.getElementById('paceSpinModalTitle').textContent;
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  const btn = this;
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-4 w-4 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
    
    const pdfWidth = 297, pdfHeight = 210, margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    const canvas = await html2canvas(modalContent, {
      scale: 2, useCORS: true, logging: false, backgroundColor: backgroundColor,
      width: modalContent.scrollWidth, height: modalContent.scrollHeight
    });
    
    const imgData = canvas.toDataURL('image/jpeg', 0.98);
    const imgWidthMM = canvas.width * 0.264583;
    const imgHeightMM = canvas.height * 0.264583;
    const ratio = Math.min(contentWidth / imgWidthMM, contentHeight / imgHeightMM);
    const scaledWidth = imgWidthMM * ratio;
    const scaledHeight = imgHeightMM * ratio;
    const xPos = margin + (contentWidth - scaledWidth) / 2;
    const yPos = margin;
    
    pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    
    const now = new Date();
    const sanitizedTitle = modalTitle.replace(/[^a-zA-Z0-9]/g, '_');
    const filename = `${sanitizedTitle}_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    pdf.save(filename);
  } catch (error) {
    console.error('PDF error:', error);
    alert('Error generating PDF.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>

<!-- PDF Download Script -->
<script>
// PDF Download for Bowling Pace & Spin Comparison Card
document.addEventListener("DOMContentLoaded", function () {
  var btn = document.getElementById('downloadPaceSpinPDFBowling');
  if (!btn) return;
  btn.addEventListener('click', async function() {
    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
    // Select all .col-span-12 cards in Bowling Pace & Spin
    const allCards = document.querySelectorAll('#paceSpinPDFContentBowling > .col-span-12');
    if (!allCards.length) return;
    btn.disabled = true;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
    try {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
      const pdfWidth = 297;
      const pdfHeight = 210;
      const margin = 10;
      const contentWidth = pdfWidth - (2 * margin);
      const contentHeight = pdfHeight - (2 * margin);
      for (let i = 0; i < allCards.length; i++) {
        const card = allCards[i];
        const canvas = await html2canvas(card, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: backgroundColor,
          windowWidth: card.scrollWidth,
          windowHeight: card.scrollHeight
        });
        const imgData = canvas.toDataURL('image/jpeg', 0.98);
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const widthRatio = contentWidth / (imgWidth * 0.264583);
        const heightRatio = contentHeight / (imgHeight * 0.264583);
        const ratio = Math.min(widthRatio, heightRatio);
        const scaledWidth = (imgWidth * 0.264583) * ratio;
        const scaledHeight = (imgHeight * 0.264583) * ratio;
        const xPos = margin + (contentWidth - scaledWidth) / 2;
        const yPos = margin + (contentHeight - scaledHeight) / 2;
        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
      }
      const now = new Date();
      const filename = `Pace_Spin_Bowling_Comparison_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
      pdf.save(filename);
    } catch (error) {
      console.error('PDF generation error:', error);
      alert('Error generating PDF. Please try again.');
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  });
});
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
// PDF Download for Bowling Pace & Spin Comparison Card
document.addEventListener("DOMContentLoaded", function () {
  var btn = document.getElementById('downloadPaceSpinPDFBowling');
  if (!btn) return;
  btn.addEventListener('click', async function() {
    const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
    const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
    // Select all .col-span-12 cards in Bowling Pace & Spin
    const allCards = document.querySelectorAll('#paceSpinPDFContentBowling > .col-span-12');
    console.log('Bowling Pace & Spin PDF: found cards:', allCards.length, allCards);
    if (!allCards.length) {
      alert('No cards found to export.');
      return;
    }
    btn.disabled = true;
    const originalText = btn.innerHTML;
    btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
    try {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
      const pdfWidth = 297;
      const pdfHeight = 210;
      const margin = 10;
      const contentWidth = pdfWidth - (2 * margin);
      const contentHeight = pdfHeight - (2 * margin);
      for (let i = 0; i < allCards.length; i++) {
        const card = allCards[i];
        const canvas = await html2canvas(card, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: backgroundColor,
          windowWidth: card.scrollWidth,
          windowHeight: card.scrollHeight
        });
        const imgData = canvas.toDataURL('image/jpeg', 0.98);
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const widthRatio = contentWidth / (imgWidth * 0.264583);
        const heightRatio = contentHeight / (imgHeight * 0.264583);
        const ratio = Math.min(widthRatio, heightRatio);
        const scaledWidth = (imgWidth * 0.264583) * ratio;
        const scaledHeight = (imgHeight * 0.264583) * ratio;
        const xPos = margin + (contentWidth - scaledWidth) / 2;
        const yPos = margin + (contentHeight - scaledHeight) / 2;
        if (i > 0) pdf.addPage();
        pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
      }
      const now = new Date();
      const filename = `Pace_Spin_Bowling_Comparison_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
      pdf.save(filename);
    } catch (error) {
      console.error('PDF generation error:', error);
      alert('Error generating PDF. Please try again.');
    } finally {
      btn.innerHTML = originalText;
      btn.disabled = false;
    }
  });
});
</script>
<script>
document.getElementById('downloadPhasePDF').addEventListener('click', async function() {
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  // Get all card containers
  const allCards = document.querySelectorAll('#pdfContent > .col-span-12');
  
  // Show loading message
  const btn = document.getElementById('downloadPhasePDF');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'landscape',
      unit: 'mm',
      format: 'a4'
    });
    
    // A4 landscape dimensions: 297mm x 210mm
    const pdfWidth = 297;
    const pdfHeight = 210;
    const margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    // Process each card separately
    for (let i = 0; i < allCards.length; i++) {
      const card = allCards[i];
      
      // Capture card as canvas
      const canvas = await html2canvas(card, {
        scale: 2,
        useCORS: true,
        logging: false,
        backgroundColor: backgroundColor,
        windowWidth: card.scrollWidth,
        windowHeight: card.scrollHeight
      });
      
      const imgData = canvas.toDataURL('image/jpeg', 0.98);
      const imgWidth = canvas.width;
      const imgHeight = canvas.height;
      
      // Calculate scaling to fit in page while maintaining aspect ratio
      const widthRatio = contentWidth / (imgWidth * 0.264583); // convert px to mm
      const heightRatio = contentHeight / (imgHeight * 0.264583);
      const ratio = Math.min(widthRatio, heightRatio);
      
      const scaledWidth = (imgWidth * 0.264583) * ratio;
      const scaledHeight = (imgHeight * 0.264583) * ratio;
      
      // Center the content
      const xPos = margin + (contentWidth - scaledWidth) / 2;
      const yPos = margin + (contentHeight - scaledHeight) / 2;
      
      // Add new page if not first card
      if (i > 0) {
        pdf.addPage();
      }
      
      // Add image to PDF
      pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    }
    
    // Get current date and time for filename
    const now = new Date();
    const filename = `Phase_Wise_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    
    // Save PDF
    pdf.save(filename);
    
  } catch (error) {
    console.error('PDF generation error:', error);
    alert('Error generating PDF. Please try again.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>

<script>
// Order Wise PDF Generation
document.getElementById('downloadOrderPDF').addEventListener('click', async function() {
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  // Get all card containers
  const allCards = document.querySelectorAll('#orderPDFContent > .col-span-12');
  
  // Show loading message
  const btn = document.getElementById('downloadOrderPDF');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'landscape',
      unit: 'mm',
      format: 'a4'
    });
    
    // A4 landscape dimensions: 297mm x 210mm
    const pdfWidth = 297;
    const pdfHeight = 210;
    const margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    // Process each card separately
    for (let i = 0; i < allCards.length; i++) {
      const card = allCards[i];
      
      // Capture card as canvas
      const canvas = await html2canvas(card, {
        scale: 2,
        useCORS: true,
        logging: false,
        backgroundColor: backgroundColor,
        windowWidth: card.scrollWidth,
        windowHeight: card.scrollHeight
      });
      
      const imgData = canvas.toDataURL('image/jpeg', 0.98);
      const imgWidth = canvas.width;
      const imgHeight = canvas.height;
      
      // Calculate scaling to fit in page while maintaining aspect ratio
      const widthRatio = contentWidth / (imgWidth * 0.264583); // convert px to mm
      const heightRatio = contentHeight / (imgHeight * 0.264583);
      const ratio = Math.min(widthRatio, heightRatio);
      
      const scaledWidth = (imgWidth * 0.264583) * ratio;
      const scaledHeight = (imgHeight * 0.264583) * ratio;
      
      // Center the content
      const xPos = margin + (contentWidth - scaledWidth) / 2;
      const yPos = margin + (contentHeight - scaledHeight) / 2;
      
      // Add new page if not first card
      if (i > 0) {
        pdf.addPage();
      }
      
      // Add image to PDF
      pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    }
    
    // Get current date and time for filename
    const now = new Date();
    const filename = `Order_Wise_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    
    // Save PDF
    pdf.save(filename);
    
  } catch (error) {
    console.error('PDF generation error:', error);
    alert('Error generating PDF. Please try again.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>

<script>
// Pace & Spin PDF Generation
document.getElementById('downloadPaceSpinPDF').addEventListener('click', async function() {
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  // Get all card containers
  const allCards = document.querySelectorAll('#paceSpinPDFContent > .col-span-12');
  
  // Show loading message
  const btn = document.getElementById('downloadPaceSpinPDF');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'landscape',
      unit: 'mm',
      format: 'a4'
    });
    
    // A4 landscape dimensions: 297mm x 210mm
    const pdfWidth = 297;
    const pdfHeight = 210;
    const margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    // Process each card separately
    for (let i = 0; i < allCards.length; i++) {
      const card = allCards[i];
      
      // Capture card as canvas
      const canvas = await html2canvas(card, {
        scale: 2,
        useCORS: true,
        logging: false,
        backgroundColor: backgroundColor,
        windowWidth: card.scrollWidth,
        windowHeight: card.scrollHeight
      });
      
      const imgData = canvas.toDataURL('image/jpeg', 0.98);
      const imgWidth = canvas.width;
      const imgHeight = canvas.height;
      
      // Calculate scaling to fit in page while maintaining aspect ratio
      const widthRatio = contentWidth / (imgWidth * 0.264583); // convert px to mm
      const heightRatio = contentHeight / (imgHeight * 0.264583);
      const ratio = Math.min(widthRatio, heightRatio);
      
      const scaledWidth = (imgWidth * 0.264583) * ratio;
      const scaledHeight = (imgHeight * 0.264583) * ratio;
      
      // Center the content
      const xPos = margin + (contentWidth - scaledWidth) / 2;
      const yPos = margin + (contentHeight - scaledHeight) / 2;
      
      // Add new page if not first card
      if (i > 0) {
        pdf.addPage();
      }
      
      // Add image to PDF
      pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    }
    
    // Get current date and time for filename
    const now = new Date();
    const filename = `Pace_Spin_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    
    // Save PDF
    pdf.save(filename);
    
  } catch (error) {
    console.error('PDF generation error:', error);
    alert('Error generating PDF. Please try again.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>

<script>
// Area Wise PDF Generation
document.getElementById('downloadAreaWisePDF').addEventListener('click', async function() {
  const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
  const backgroundColor = currentTheme === 'dark' ? '#1e293b' : '#ffffff';
  
  // Get the content container
  const content = document.getElementById('areaWisePDFContent');
  
  // Show loading message
  const btn = document.getElementById('downloadAreaWisePDF');
  const originalText = btn.innerHTML;
  btn.innerHTML = '<svg class="animate-spin h-5 w-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Generating PDF...';
  btn.disabled = true;
  
  try {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'landscape',
      unit: 'mm',
      format: 'a4'
    });
    
    // A4 landscape dimensions: 297mm x 210mm
    const pdfWidth = 297;
    const pdfHeight = 210;
    const margin = 10;
    const contentWidth = pdfWidth - (2 * margin);
    const contentHeight = pdfHeight - (2 * margin);
    
    // Capture content as canvas
    const canvas = await html2canvas(content, {
      scale: 2,
      useCORS: true,
      logging: false,
      backgroundColor: backgroundColor,
      windowWidth: content.scrollWidth,
      windowHeight: content.scrollHeight
    });
    
    const imgData = canvas.toDataURL('image/jpeg', 0.98);
    const imgWidth = canvas.width;
    const imgHeight = canvas.height;
    
    // Calculate scaling to fit in page while maintaining aspect ratio
    const widthRatio = contentWidth / (imgWidth * 0.264583); // convert px to mm
    const heightRatio = contentHeight / (imgHeight * 0.264583);
    const ratio = Math.min(widthRatio, heightRatio);
    
    const scaledWidth = (imgWidth * 0.264583) * ratio;
    const scaledHeight = (imgHeight * 0.264583) * ratio;
    
    // Center the content
    const xPos = margin + (contentWidth - scaledWidth) / 2;
    const yPos = margin + (contentHeight - scaledHeight) / 2;
    
    // Add image to PDF
    pdf.addImage(imgData, 'JPEG', xPos, yPos, scaledWidth, scaledHeight);
    
    // Get current date and time for filename
    const now = new Date();
    const filename = `Area_Wise_Report_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}_${now.getHours()}.${now.getMinutes()}.pdf`;
    
    // Save PDF
    pdf.save(filename);
    
  } catch (error) {
    console.error('PDF generation error:', error);
    alert('Error generating PDF. Please try again.');
  } finally {
    btn.innerHTML = originalText;
    btn.disabled = false;
  }
});
</script>


{% endblock %}




